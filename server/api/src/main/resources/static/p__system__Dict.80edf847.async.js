(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[8270],{25855:function(ae,$,t){"use strict";t.r($),t.d($,{default:function(){return te}});var se=t(57663),R=t(71577),h=t(39428),O=t(3182),re=t(71194),w=t(50146),ie=t(71153),K=t(60331),D=t(94657),M=t(3980),V=t(87588),F=t(51042),A=t(36450),G=t(16894),L=t(93279),E=t(80582),x=t(67294),b=t(42285),v=t(11849),N=t(96389),U=t(50727),ne=t(34792),B=t(48086),de=t(43185),Y=t(28525),z=t(69753),J=t(84391),W=t(43347),e=t(85893),H=Y.Z.Dragger;function Q(f){var r=f.current,Z=f.onCancel,d=f.onOk,s=(0,x.useState)(!1),g=(0,D.Z)(s,2),i=g[0],u=g[1],l=(0,x.useState)([]),c=(0,D.Z)(l,2),o=c[0],y=c[1],a=(0,b.YB)(),T={multiple:!1,accept:".xlsx",beforeUpload:function(n){return y([n]),!1},onRemove:function(){y([])},maxCount:1};return(0,e.jsx)(w.Z,{title:a.formatMessage({id:"pages.system.dict.import.title",defaultMessage:"Excel\u6A21\u677F\u5BFC\u5165\u5B57\u5178\u9879"}),onCancel:Z,open:!0,maskClosable:!1,footer:[(0,e.jsx)(R.Z,{onClick:Z,children:a.formatMessage({id:"pages.common.cancel",defaultMessage:"\u53D6\u6D88"})},"cancel"),(0,e.jsx)(R.Z,{icon:(0,e.jsx)(z.Z,{}),onClick:function(){M.hi.download("/api/file/downloadTemplate?name=\u5B57\u5178\u5BFC\u5165\u6A21\u677F")},children:a.formatMessage({id:"pages.system.dict.import.download",defaultMessage:"\u4E0B\u8F7D\u6A21\u677F"})},"downloadTemplate"),(0,e.jsx)(R.Z,{icon:(0,e.jsx)(J.Z,{}),type:"primary",loading:i,onClick:function(){if(o.length===0){B.default.error(a.formatMessage({id:"pages.system.dict.import.noFile",defaultMessage:"\u8BF7\u9009\u62E9\u6587\u4EF6"}));return}u(!0),M.hi.importDictItems({file:o[0],dictCode:r.code}).then(function(n){u(!1),n.success?(B.default.success(a.formatMessage({id:"pages.system.dict.import.success",defaultMessage:"\u5BFC\u5165\u6210\u529F"})),d()):B.default.error(n.message)})},children:a.formatMessage({id:"pages.common.import",defaultMessage:"\u5BFC\u5165"})},"importTemplate")],children:(0,e.jsxs)(H,(0,v.Z)((0,v.Z)({},T),{},{children:[(0,e.jsx)("p",{className:"ant-upload-drag-icon",children:(0,e.jsx)(W.Z,{})}),(0,e.jsx)("p",{className:"ant-upload-text",children:a.formatMessage({id:"pages.common.upload.drag",defaultMessage:"\u70B9\u51FB\u6216\u8005\u62D6\u62FDExcel\u6587\u4EF6\u5230\u6B64\u5904"})})]}))})}var X=(0,E.Pi)(function(f){var r=f.dict,Z=f.onClose,d=(0,x.useRef)(),s=(0,b.YB)(),g=(0,x.useState)([]),i=(0,D.Z)(g,2),u=i[0],l=i[1],c=(0,x.useState)(!1),o=(0,D.Z)(c,2),y=o[0],a=o[1],T=[{title:s.formatMessage({id:"pages.system.dict.item.column.name",defaultMessage:"\u5B57\u5178\u9879\u540D\u79F0"}),dataIndex:"itemName",formItemProps:function(n,p){var C=p.rowIndex;return{rules:[{required:!0,message:s.formatMessage({id:"pages.system.dict.item.required",defaultMessage:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"})}]}}},{title:s.formatMessage({id:"pages.system.dict.item.column.value",defaultMessage:"\u5B57\u5178\u9879\u503C"}),dataIndex:"itemValue",formItemProps:function(n,p){var C=p.rowIndex;return{rules:[{required:!0,message:s.formatMessage({id:"pages.system.dict.item.required",defaultMessage:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"})}]}}},{title:s.formatMessage({id:"pages.system.dict.item.column.parentValue",defaultMessage:"\u7236\u5B57\u5178\u9879\u503C"}),dataIndex:"parentItemValue"},{title:s.formatMessage({id:"pages.system.dict.item.column.level",defaultMessage:"\u5C42\u7EA7"}),dataIndex:"itemLevel",valueType:"digit"},{title:s.formatMessage({id:"pages.system.dict.item.column.order",defaultMessage:"\u987A\u5E8F"}),dataIndex:"itemOrder",valueType:"digit",tooltip:s.formatMessage({id:"pages.system.dict.item.order.tooltip",defaultMessage:"\u6570\u5B57\u8D8A\u5C0F\uFF0C\u4F18\u5148\u7EA7\u8D8A\u9AD8"})},{title:s.formatMessage({id:"pages.system.dict.item.column.actions",defaultMessage:"\u64CD\u4F5C"}),valueType:"option",render:function(n,p,C,j){return[(0,e.jsx)("a",{onClick:function(){var k;j==null||(k=j.startEditable)===null||k===void 0||k.call(j,p.id)},children:s.formatMessage({id:"pages.common.edit",defaultMessage:"\u7F16\u8F91"})},"editable")]}}];return(0,e.jsxs)(w.Z,{open:!0,title:!1,onCancel:Z,footer:!1,width:800,maskClosable:!1,children:[(0,e.jsx)(U.Z,{columns:T,actionRef:d,bordered:!0,request:function(){var m=(0,O.Z)((0,h.Z)().mark(function n(p){var C;return(0,h.Z)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,M.hi.loadDictItems((0,v.Z)((0,v.Z)({},p),{},{dictCode:r.code}));case 2:return C=I.sent,I.abrupt("return",{success:!0,data:C.list,total:C.total});case 4:case"end":return I.stop()}},n)}));return function(n){return m.apply(this,arguments)}}(),columnsState:{persistenceKey:"system-dictItem",persistenceType:"localStorage"},rowKey:"id",pagination:{pageSize:100},recordCreatorProps:{record:function(){return{id:(0,N.kb)(8)}}},editable:{type:"multiple",editableKeys:u,onSave:function(){var m=(0,O.Z)((0,h.Z)().mark(function p(C,j,I){return(0,h.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.abrupt("return",M.hi.saveOrUpdateDictItem((0,v.Z)((0,v.Z)({},j),{},{dictCode:r.code})));case 1:case"end":return P.stop()}},p)}));function n(p,C,j){return m.apply(this,arguments)}return n}(),onDelete:function(n,p){return M.hi.deleteDictItem(n)},onChange:l},dateFormatter:"string",headerTitle:s.formatMessage({id:"pages.system.dict.item.header",defaultMessage:"\u5B57\u5178\u9879\u5217\u8868"}),toolBarRender:function(){return[(0,e.jsx)(R.Z,{icon:(0,e.jsx)(F.Z,{}),type:"primary",onClick:function(){return a(!0)},children:s.formatMessage({id:"pages.common.import",defaultMessage:"\u5BFC\u5165"})},"button")]}}),y&&(0,e.jsx)(Q,{current:r,onCancel:function(){return a(!1)},onOk:function(){var n;a(!1),(n=d.current)===null||n===void 0||n.reload()}})]})}),q=X,S=t(21307),_=(0,E.Pi)(function(f){var r=f.onOk,Z=f.onClose,d=f.dict,s=(0,x.useRef)(),g=!!(d!=null&&d.id),i=(0,b.YB)();return(0,e.jsxs)(S.aN,{title:g?i.formatMessage({id:"pages.system.dict.drawer.edit",defaultMessage:"\u4FEE\u6539\u5B57\u5178"}):i.formatMessage({id:"pages.system.dict.drawer.create",defaultMessage:"\u65B0\u589E\u5B57\u5178"}),formRef:s,visible:!0,initialValues:d,drawerProps:{forceRender:!0,destroyOnClose:!0,onClose:function(){Z()}},onFinish:function(){var u=(0,O.Z)((0,h.Z)().mark(function l(c){var o;return(0,h.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(d!=null&&d.id)){a.next=6;break}return a.next=3,M.hi.updateDict((0,v.Z)((0,v.Z)({},d),c));case 3:o=a.sent,a.next=9;break;case 6:return a.next=8,M.hi.saveDict((0,v.Z)((0,v.Z)({},d),c));case 8:o=a.sent;case 9:o.success&&r();case 10:case"end":return a.stop()}},l)}));return function(l){return u.apply(this,arguments)}}(),children:[(0,e.jsxs)(S.ZP.Group,{children:[(0,e.jsx)(S.V,{name:"name",width:"md",label:i.formatMessage({id:"pages.system.dict.field.name.label",defaultMessage:"\u5B57\u5178\u540D\u79F0"}),placeholder:i.formatMessage({id:"pages.system.dict.field.name.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u5B57\u5178\u540D\u79F0"}),required:!0,rules:[{required:!0,message:i.formatMessage({id:"pages.system.dict.field.name.required",defaultMessage:"\u5B57\u5178\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"})}]}),(0,e.jsx)(S._I,{name:"dictType",width:"md",label:i.formatMessage({id:"pages.system.dict.field.type.label",defaultMessage:"\u5B57\u5178\u7C7B\u578B"}),placeholder:i.formatMessage({id:"pages.system.dict.field.type.placeholder",defaultMessage:"\u8BF7\u9009\u62E9\u5B57\u5178\u7C7B\u578B"}),required:!0,tooltip:i.formatMessage({id:"pages.system.dict.field.type.tooltip",defaultMessage:"\u7CFB\u7EDF\u5B57\u5178\u4E0D\u80FD\u5220\u9664\uFF0C\u95EE\u5377\u5B57\u5178\u7528\u4E8E\u95EE\u5377\u6A2A\u5411\u586B\u7A7A\u9898\u4E0B\u62C9"}),options:[{label:i.formatMessage({id:"pages.system.dict.type.survey",defaultMessage:"\u95EE\u5377\u5B57\u5178"}),value:1}],rules:[{required:!0,message:i.formatMessage({id:"pages.system.dict.field.type.required",defaultMessage:"\u5B57\u5178\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A"})}]}),(0,e.jsx)(S.V,{width:"md",name:"code",label:i.formatMessage({id:"pages.system.dict.field.code.label",defaultMessage:"\u5B57\u5178\u7F16\u7801"}),placeholder:i.formatMessage({id:"pages.system.dict.field.code.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u5B57\u5178\u7F16\u7801"}),rules:[{required:!0,message:i.formatMessage({id:"pages.system.dict.field.code.required",defaultMessage:"\u5B57\u5178\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A"})}],required:!0})]}),(0,e.jsx)(S.ZP.Group,{children:(0,e.jsx)(S.$J,{name:"remark",width:"xl",label:i.formatMessage({id:"pages.system.dict.field.remark.label",defaultMessage:"\u63CF\u8FF0"}),placeholder:i.formatMessage({id:"pages.system.dict.field.remark.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u5B57\u5178\u63CF\u8FF0\u4FE1\u606F"})})})]})}),ee=(0,E.Pi)(function(){var f=(0,x.useRef)(),r=(0,b.YB)(),Z=(0,x.useState)(),d=(0,D.Z)(Z,2),s=d[0],g=d[1],i=[{title:r.formatMessage({id:"pages.system.dict.column.name",defaultMessage:"\u5B57\u5178\u540D\u79F0"}),dataIndex:"name",ellipsis:!0},{title:r.formatMessage({id:"pages.system.dict.column.code",defaultMessage:"\u5B57\u5178\u7F16\u7801"}),dataIndex:"code",hideInSearch:!0},{title:r.formatMessage({id:"pages.system.dict.column.type",defaultMessage:"\u5B57\u5178\u7C7B\u578B"}),dataIndex:"dictType",hideInSearch:!0,renderText:function(l){return l===2?(0,e.jsx)(K.Z,{color:"red",children:r.formatMessage({id:"pages.system.dict.type.system",defaultMessage:"\u7CFB\u7EDF\u5B57\u5178"})}):(0,e.jsx)(K.Z,{color:"green",children:r.formatMessage({id:"pages.system.dict.type.survey",defaultMessage:"\u95EE\u5377\u5B57\u5178"})})}},{title:r.formatMessage({id:"pages.system.dict.column.description",defaultMessage:"\u63CF\u8FF0"}),dataIndex:"remark",search:!1},{title:r.formatMessage({id:"pages.system.dict.column.createdAt",defaultMessage:"\u521B\u5EFA\u65F6\u95F4"}),key:"showTime",dataIndex:"createAt",hideInSearch:!0,width:200},{title:r.formatMessage({id:"pages.system.dict.column.actions",defaultMessage:"\u64CD\u4F5C"}),valueType:"option",width:200,render:function(l,c){return c.dictType===2?[(0,e.jsx)("a",{onClick:function(){g({visible:!0,current:c,type:"dictItem"})},children:r.formatMessage({id:"pages.system.dict.action.items",defaultMessage:"\u5B57\u5178\u9879"})},"readonly")]:[(0,e.jsx)("a",{onClick:function(){g({visible:!0,current:c,type:"dictItem"})},children:r.formatMessage({id:"pages.system.dict.action.items",defaultMessage:"\u5B57\u5178\u9879"})},"readonly"),(0,e.jsx)(L.Z,{onSelect:function(y){y==="edit"&&g({current:c,visible:!0,type:"dict"}),y==="delete"&&w.Z.confirm({title:r.formatMessage({id:"pages.system.dict.modal.delete.title",defaultMessage:"\u5220\u9664"}),content:r.formatMessage({id:"pages.system.dict.modal.delete.content",defaultMessage:"\u786E\u5B9A\u5220\u9664\u5F53\u524D\u5B57\u5178?"}),icon:(0,e.jsx)(V.Z,{}),okText:r.formatMessage({id:"pages.common.delete",defaultMessage:"\u5220\u9664"}),cancelText:r.formatMessage({id:"pages.common.cancel",defaultMessage:"\u53D6\u6D88"}),onOk:function(){M.hi.deleteDict(c.id).then(function(){var T;(T=f.current)===null||T===void 0||T.reload()})}})},menus:[{key:"edit",name:r.formatMessage({id:"pages.common.edit",defaultMessage:"\u7F16\u8F91"})},{key:"delete",name:r.formatMessage({id:"pages.common.delete",defaultMessage:"\u5220\u9664"})}]},"actionGroup")]}}];return(0,e.jsxs)(A._z,{title:!1,children:[(0,e.jsx)(G.ZP,{columns:i,bordered:!0,actionRef:f,request:function(){var u=(0,O.Z)((0,h.Z)().mark(function l(c){var o;return(0,h.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,M.hi.loadDicts(c);case 2:return o=a.sent,a.abrupt("return",{success:!0,data:o.list,total:o.total});case 4:case"end":return a.stop()}},l)}));return function(l){return u.apply(this,arguments)}}(),scroll:{x:800},columnsState:{persistenceKey:"system-dict",persistenceType:"localStorage"},rowKey:"id",search:{labelWidth:"auto"},pagination:{defaultPageSize:10},dateFormatter:"string",headerTitle:r.formatMessage({id:"pages.system.dict.header",defaultMessage:"\u5B57\u5178\u5217\u8868"}),toolBarRender:function(){return[(0,e.jsx)(R.Z,{icon:(0,e.jsx)(F.Z,{}),type:"primary",onClick:function(){g({visible:!0,type:"dict"})},children:r.formatMessage({id:"pages.system.dict.toolbar.new",defaultMessage:"\u65B0\u5EFA"})},"button")]}}),(s==null?void 0:s.visible)&&s.type==="dict"&&(0,e.jsx)(_,{onClose:function(){g(void 0)},onOk:function(){var l;g(void 0),(l=f.current)===null||l===void 0||l.reload()},dict:s.current}),(s==null?void 0:s.current)&&s.type==="dictItem"&&(0,e.jsx)(q,{onClose:function(){g(void 0)},dict:s.current})]})}),te=ee}}]);
