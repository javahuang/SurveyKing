(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[650],{1997:function(da,je,a){"use strict";a.d(je,{ML:function(){return Re},tC:function(){return Oe},sJ:function(){return Pe},ZP:function(){return oa}});var u=a(71194),R=a(50146),me=a(57663),A=a(71577),Ze=a(49111),z=a(19650),ca=a(77576),fe=a(12028),fa=a(22385),we=a(94199),W=a(402),Ue=a(56118),ue=a(94184),Ne=a.n(ue),C=a(67294),he=a(94657),Te=a(29656),ze=a(63138),Ie=a(88386),e=a(85893),Ye=(0,C.forwardRef)(function(l,n){var f=l.value,g=l.readOnly,Z=l.placeholder,S=(0,C.useState)(),D=(0,he.Z)(S,2),O=D[0],$=D[1];(0,C.useEffect)(function(){O&&O.focus()},[O]),(0,C.useImperativeHandle)(n,function(){return{getValue:function(){return O.getValue()},focus:function(){O.focus()},getDoc:function(){return O.getDoc()}}});var _=(0,C.useMemo)(function(){return{mode:"text/x-spreadsheet",line:!0,lineWrapping:!0,readOnly:g,placeholder:Z}},[g]),ie=function(V,k,L,ee,T){var w=V.getDoc(),K=document.createElement("span");K.innerText=ee.title||ee.path,K.className="formula-tag ".concat(T||"formula-tag-value"),w.markText(k,L,{replacedWith:K})},B=function H(V,k,L){var ee=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];(ee||[]).forEach(function(T){for(var w="#{".concat(T.path,"}"),K=new RegExp(w,"g");K.exec(k)!==null;){var ye={line:L,ch:K.lastIndex-w.length},Ee={line:L,ch:K.lastIndex};ie(V,ye,Ee,T)}for(w="#{_".concat(T.path,"}"),K=new RegExp(w,"g");K.exec(k)!==null;){var Se={line:L,ch:K.lastIndex-w.length},oe={line:L,ch:K.lastIndex};ie(V,Se,oe,T,"formula-tag-text")}T.children&&T.children.length>0&&H(V,k,L,T.children)})},ne=function(V,k){var L=k.split(`
`);L.forEach(function(ee,T){return B(V,ee,T,l.variable)})},le=function(V,k){$(V),f!=null&&f!==""&&ne(V,k)},ce=function(V,k,L){(L!=null||L!=="")&&ne(V,L),l.onChange&&l.onChange(L)};return(0,e.jsx)("div",{className:Ne()("formula-editor-content",{readOnly:g}),children:(0,e.jsx)(Te.Rt,{autoCursor:!1,value:f,options:_,editorDidMount:le,onChange:ce})})}),Re=Ye,$e=a(63783),va=a(18106),He=a(72488),Na=a(47673),se=a(77808),Ke=a(83279),ma=a(20136),We=a(55241),Ta=a(7359),G=a(27279),ga=G.Z.Panel,ve=Ue.Z.Link;function Ge(l,n,f){if(l.popover){var g,Z;return(0,e.jsx)(We.Z,{content:(0,e.jsxs)("div",{className:"fn-popover-content",children:[(0,e.jsxs)("div",{className:"fn-popover-content-header",children:["\u516C\u5F0F\u7B80\u4ECB",(0,e.jsx)(ve,{href:l.popover.docHref,target:"_blank",children:"\u6587\u6863"})]}),(g=l.popover)===null||g===void 0?void 0:g.content]}),title:(Z=l.popover)===null||Z===void 0?void 0:Z.title,placement:"right",className:"fn-popover",children:(0,e.jsxs)("div",{className:"function-item",onClick:function(){return f&&f(l.name)},children:[(0,e.jsx)("div",{className:"function-item__name",children:l.name}),(0,e.jsx)("div",{className:"function-item__desc",children:l.description})]})},n)}return(0,e.jsxs)("div",{className:"function-item",onClick:function(){return f&&f(l.name)},children:[(0,e.jsx)("div",{className:"function-item__name",children:l.name}),(0,e.jsx)("div",{className:"function-item__desc",children:l.description})]},n)}var de=function(n){var f=n.dataSource,g=f===void 0?[]:f,Z=n.check,S="function-store";return(0,e.jsx)(G.Z,{className:S,bordered:!1,defaultActiveKey:[0],expandIconPosition:"right",ghost:!0,children:g.map(function(D,O){return(0,e.jsx)(ga,{className:"".concat(S,"-group"),header:D.name,children:D.functions.map(function($,_){return Ge($,_,Z)})},O)})})},pa=de,Ce=a(11849),Qe=function(l){return(0,e.jsx)("svg",(0,Ce.Z)((0,Ce.Z)({width:"1em",height:"1.2em",viewBox:"0 0 24 24"},l),{},{children:(0,e.jsx)("path",{d:"M12.42 5.29c-1.1-.1-2.07.71-2.17 1.82L10 10h2.82v2h-3l-.44 5.07A4.001 4.001 0 0 1 2 18.83l1.5-1.5c.33 1.05 1.46 1.64 2.5 1.3c.78-.24 1.33-.93 1.4-1.74L7.82 12h-3v-2H8l.27-3.07a4.01 4.01 0 0 1 4.33-3.65c1.26.11 2.4.81 3.06 1.89l-1.5 1.5c-.25-.77-.93-1.31-1.74-1.38M22 13.65l-1.41-1.41l-2.83 2.83l-2.83-2.83l-1.43 1.41l2.85 2.85l-2.85 2.81l1.43 1.41l2.83-2.83l2.83 2.83L22 19.31l-2.83-2.81L22 13.65z",fill:"currentColor"})}))},xe=function(l){return(0,e.jsx)("svg",(0,Ce.Z)((0,Ce.Z)({width:"1em",height:"1em",viewBox:"0 0 16 16"},l),{},{children:(0,e.jsx)("g",{fill:"currentColor",children:(0,e.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 5h2V4H1.5l-.5.5v8l.5.5H4v-1H2V5zm12.5-1H12v1h2v7h-2v1h2.5l.5-.5v-8l-.5-.5zm-2.74 2.57L12 7v2.51l-.3.45l-4.5 2h-.46l-2.5-1.5l-.24-.43v-2.5l.3-.46l4.5-2h.46l2.5 1.5zM5 9.71l1.5.9V9.28L5 8.38v1.33zm.58-2.15l1.45.87l3.39-1.5l-1.45-.87l-3.39 1.5zm1.95 3.17l3.5-1.56v-1.4l-3.5 1.55v1.41z"})})}))},ha=a(32157),Xe=a(38614),Je=a(34804),qe=function(n){var f=n.id,g=n.type,Z=n.title,S=n.pick,D=(0,C.useMemo)(function(){return g==="SplitLine"},[]);return(0,e.jsx)("div",{className:Ne()("field-variable",{disabled:D}),onClick:function(){S&&S()},children:Z})},_e=qe;function Be(l,n){return{title:(0,e.jsx)(_e,{type:l.type,id:l.id,title:l.title,pick:function(){return n&&n(l)}}),key:l.id,children:(l.children||[]).map(function(f){return Be(f,n)})}}var ea=function(n){var f=n.dataSource,g=n.pick,Z=(0,C.useMemo)(function(){return f.map(function(S){return Be(S,g)})},[g]);return(0,e.jsx)(Xe.Z,{blockNode:!0,defaultExpandAll:!0,showLine:{showLeafIcon:!1},switcherIcon:(0,e.jsx)(Je.Z,{}),className:"hide-file-icon",treeData:Z,selectable:!1})},aa=ea,be=a(40110),Ia=a(54421),Ae=a(38272),xa=function(n){var f=n.check,g=n.dataSource;return(0,e.jsx)(Ae.ZP,{bordered:!1,dataSource:g,className:"function-store-group",renderItem:function(S){return(0,e.jsx)(Ae.ZP.Item,{children:Ge(S,S.name,f)})}})},ta=xa,ya=function(n){var f=n.variables,g=f===void 0?[]:f,Z=n.insertFun,S=n.insertVariable,D=n.functionVisible,O=D===void 0?!0:D,$=n.helperVariables,_="formula-editor-toolbar",ie=(0,C.useState)([]),B=(0,he.Z)(ie,2),ne=B[0],le=B[1],ce=(0,C.useCallback)(function(k){return(0,e.jsxs)("span",{children:[k.icon?(0,e.jsx)("span",{role:"img",className:"anticon",children:k.icon}):null,k.name]})},[]),H=function(L){var ee;if(!L){le([]);return}var T=new Set;le(((ee=n.functions)===null||ee===void 0?void 0:ee.reduce(function(w,K){return w.push.apply(w,(0,Ke.Z)(K.functions.filter(function(ye){return ye.name.includes(L.toUpperCase())}))),w},[]).filter(function(w){return T.has(w.name)?!1:(T.add(w.name),!0)}))||[])},V=[{key:"field",label:(0,e.jsx)(ce,{name:"\u95EE\u9898",icon:(0,e.jsx)(xe,{})}),children:(0,e.jsx)("div",{children:(0,e.jsx)(aa,{dataSource:g,pick:S})})}];return $&&V.push({key:"helperFiled",label:(0,e.jsx)(ce,{name:"\u547D\u540D\u53D8\u91CF",icon:(0,e.jsx)(xe,{})}),children:(0,e.jsx)("div",{children:(0,e.jsx)(aa,{dataSource:$,pick:S})})}),O&&V.push({key:"fx",label:(0,e.jsx)(ce,{name:"\u51FD\u6570",icon:(0,e.jsx)(Qe,{})}),children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(se.Z,{placeholder:"\u641C\u7D22\u516C\u5F0F",prefix:(0,e.jsx)(be.Z,{}),allowClear:!0,onChange:function(L){return H(L.target.value)}}),ne.length>0&&(0,e.jsx)(ta,{dataSource:ne,check:Z}),ne.length===0&&(0,e.jsx)(pa,{dataSource:n.functions,check:Z})]})}),(0,e.jsx)("div",{className:_,children:(0,e.jsx)(He.Z,{defaultActiveKey:"field",centered:O,items:V})})};function q(l){for(var n=arguments.length,f=new Array(n>1?n-1:0),g=1;g<n;g++)f[g-1]=arguments[g];return(0,e.jsxs)("div",{className:"fn-popover-title",children:[l,"(",f.map(function(Z,S){return(0,e.jsxs)("span",{className:"fn-popover-arg",children:[Z," ",S===f.length-1?"":","]},S)}),")"]})}var sa="https://support.microsoft.com/zh-cn/office/",P=[{name:"\u903B\u8F91",functions:[{name:"IF",description:"\u6839\u636E\u5224\u65AD\u6761\u4EF6\uFF0C\u8FD4\u56DE\u6B63\u786E\u6216\u9519\u8BEF\u7684\u503C"},{name:"AND",description:"\u8FD4\u56DE\u903B\u8F91\u503C\uFF1A\u5982\u679C\u6240\u6709\u53C2\u6570\u503C\u5747\u4E3A\u903B\u8F91\u201Ctrue\u201D\uFF0C\u5219\u8FD4\u56DE\u903B\u8F91\u201Ctrue\u201D\uFF0C\u53CD\u4E4B\u8FD4\u56DE\u903B\u8F91\u201Cfalse",popover:{title:q("AND","logical1","logical2","..."),content:(0,e.jsxs)("div",{className:"fn-popover-content",children:["\u4EFB\u4F55\u4E00\u4E2A\u53C2\u6570\u7684\u903B\u8F91\u503C\u4E3Afalse\uFF0C\u5373\u8FD4\u56DE false\uFF1B",(0,e.jsx)("br",{})," \u53EA\u6709\u5F53\u6240\u6709\u53C2\u6570\u7684\u903B\u8F91\u503C\u4E3Atrue\uFF0C\u624D\u8FD4\u56DE true\u3002",(0,e.jsx)("br",{}),"logical:\u903B\u8F91\u503C\uFF0C\u4F8B\u5982\uFF0C2>1\u7684\u903B\u8F91\u503C\u4E3A true"]})}},{name:"OR",description:"\u4EFB\u4F55\u4E00\u4E2A\u53C2\u6570\u903B\u8F91\u503C\u4E3Atrue\uFF0C\u5373\u8FD4\u56DEtrue\uFF1B\u53EA\u6709\u5F53\u6240\u6709\u903B\u8F91\u53C2\u6570\u503C\u4E3Afalse\uFF0C\u624D\u8FD4\u56DEfalse"},{name:"XOR",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u6570\u7684\u5F02\u6216\u503C"},{name:"NOT",description:"\u5BF9\u53C2\u6570\u903B\u8F91\u503C\u6C42\u53CD"}]},{name:"\u6587\u5B57",functions:[{name:"SUBSTITUTE",description:"\u5728\u6587\u672C\u5B57\u7B26\u4E32\u4E2D\u7528 new_text \u66FF\u6362 old_text",popover:{title:q("SUBSTITUTE","old_text","new_text","[instance_num]"),content:(0,e.jsxs)("div",{className:"fn-popover-content",children:["\u5728\u6587\u672C\u5B57\u7B26\u4E32\u4E2D\u7528 new_text \u66FF\u6362 old_text\u3002",(0,e.jsx)("br",{}),"\u5982\u679C\u9700\u8981\u5728\u67D0\u4E00\u6587\u672C\u5B57\u7B26\u4E32\u4E2D\u66FF\u6362\u6307\u5B9A\u7684\u6587\u672C\uFF0C\u8BF7\u4F7F\u7528\u51FD\u6570 SUBSTITUTE\uFF1B",(0,e.jsx)("br",{}),"\u5982\u679C\u9700\u8981\u5728\u67D0\u4E00\u6587\u672C\u5B57\u7B26\u4E32\u4E2D\u66FF\u6362\u7279\u5B9A\u4F4D\u7F6E\u5904\u7684\u4EFB\u610F\u6587\u672C\uFF0C\u8BF7\u4F7F\u7528\u51FD\u6570 REPLACE\u3002"]}),docHref:"".concat(sa,"substitute-\u51FD\u6570-6434944e-a904-4336-a9b0-1e58df3bc332")}},{name:"CONCATENATE",description:"\u5C06\u591A\u4E2A\u6587\u5B57\u5408\u5E76"},{name:"LEFT",description:"\u4ECE\u5DE6\u8FB9\u622A\u53D6\u6307\u5B9A\u957F\u5EA6\u7684\u6587\u5B57"},{name:"RIGHT",description:"\u4ECE\u53F3\u8FB9\u8FB9\u622A\u53D6\u6307\u5B9A\u957F\u5EA6\u7684\u6587\u5B57"},{name:"MID",description:"\u622A\u53D6\u6307\u5B9A\u4F4D\u7F6E\u7684\u6587\u5B57"},{name:"REPLACE",description:"\u66FF\u6362\u6587\u672C\u4E2D\u7684\u6307\u5B9A\u6587\u5B57",popover:{title:q("REPLACE","old_text","start_num","num_chars","new_text"),content:(0,e.jsxs)("div",{className:"fn-popover-content",children:["\u6839\u636E\u6307\u5B9A\u7684\u5B57\u7B26\u6570\uFF0CREPLACE \u5C06\u90E8\u5206\u6587\u672C\u5B57\u7B26\u4E32\u66FF\u6362\u4E3A\u4E0D\u540C\u7684\u6587\u672C\u5B57\u7B26\u4E32\u3002",(0,e.jsx)("br",{}),"REPLACEB \u4F7F\u7528\u5176\u4ED6\u6587\u672C\u5B57\u7B26\u4E32\u5E76\u6839\u636E\u6240\u6307\u5B9A\u7684\u5B57\u8282\u6570\u66FF\u6362\u67D0\u6587\u672C\u5B57\u7B26\u4E32\u4E2D\u7684\u90E8\u5206\u6587\u672C\u3002"]}),docHref:"".concat(sa,"replace-replaceb-\u51FD\u6570-8d799074-2425-4a8a-84bc-82472868878a")}},{name:"TRIM",description:"\u79FB\u9664\u6587\u5B57\u5934\u5C3E\u7684\u7A7A\u683C"},{name:"LEN",description:"\u540E\u53BB\u6587\u5B57\u7684\u957F\u5EA6"},{name:"LOWER",description:"\u8F6C\u6210\u5C0F\u5199\u6587\u5B57"},{name:"UPPER",description:"\u8F6C\u6210\u5927\u5199\u6587\u5B57"}]},{name:"\u6570\u5B57",functions:[{name:"AVERAGE",description:"\u8BA1\u7B97\u6240\u6709\u53C2\u4E0E\u8FD0\u7B97\u5B57\u6BB5\u7684\u5E73\u5747\u503C"},{name:"COUNT",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u4E0E\u8FD0\u7B97\u5B57\u6BB5\u4E2D\u503C\u6570\u5B57\u7684\u6570\u91CF"},{name:"COUNTA",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u4E0E\u8FD0\u7B97\u5B57\u6BB5\u4E2D\u503C\u4E0D\u4E3A\u7A7A\u7684\u6570\u91CF"},{name:"COUNTIF",description:"COUNTIF(\u8868\u683C[\u91D1\u989D], 100)\uFF0C\u53EF\u5F97\u5230\u8868\u683C\u4E2D\u91D1\u989D\u4E3A100\u7684\u6570\u636E\u6761\u6570"},{name:"MAX",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u4E0E\u5B57\u6BB5\u4E2D\u7684\u6700\u5927\u503C"},{name:"MIN",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u4E0E\u5B57\u6BB5\u4E2D\u7684\u6700\u5C0F\u503C"},{name:"ROUND",description:"\u5C06\u6570\u5B57\u56DB\u820D\u4E94\u5165\u5230\u6307\u5B9A\u7684\u4F4D\u6570"},{name:"INT",description:"\u5C06\u6570\u5B57\u5411\u4E0B\u53D6\u6574"},{name:"MOD",description:"\u8FD4\u56DE\u4E24\u6570\u76F8\u9664\u7684\u4F59\u6570"},{name:"PRODUCT",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u4E0E\u5B57\u6BB5\u4E2D\u6570\u503C\u7684\u4E58\u79EF"},{name:"SUM",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u4E0E\u5B57\u6BB5\u4E2D\u6570\u503C\u7684\u603B\u548C"},{name:"SUMPRODUCT",description:"\u8FD4\u56DE\u6240\u6709\u53C2\u4E0E\u5B57\u6BB5\u4E2D\u6570\u503C\u7684\u603B\u548C"},{name:"SUMIF",description:"\u7EDF\u8BA1\u8868\u683C\u4E2D\u7B26\u5408\u6761\u4EF6\u7684\u6570\u503C\uFF0C\u5E76\u6C42\u548C"},{name:"ROUNDUP",description:"\u5C06\u6570\u5B57\u4FDD\u7559\u6307\u5B9A\u7684\u4F4D\u6570\uFF0C\u6700\u540E\u4E00\u4F4D\u5411\u4E0A\u53D6"},{name:"ROUNDDOWN",description:"\u5C06\u6570\u5B57\u4FDD\u7559\u6307\u5B9A\u7684\u4F4D\u6570\uFF0C\u6700\u540E\u4E00\u4F4D\u5411\u4E0B\u53D6"},{name:"POWER",description:"\u8BA1\u7B97\u6570\u5B57num\u7684n\u6B21\u65B9\uFF0Cn\u53EF\u4EE5\u4E3A\u5206\u6570\u6216\u8005\u6574\u6570"},{name:"LN",description:"\u8BA1\u7B97\u6307\u5B9A\u6570\u5B57\u7684\u81EA\u7136\u5BF9\u6570"},{name:"SQRT",description:"\u8BA1\u7B97\u6307\u5B9A\u6570\u5B57\u7684\u5E73\u65B9\u6839"}]},{name:"\u65F6\u95F4",functions:[{name:"YEAR",description:"\u8FD4\u56DE\u65E5\u671F\u4E2D\u7684\u5E74\u4EFD"},{name:"MONTH",description:"\u8FD4\u56DE\u65E5\u671F\u4E2D\u7684\u6708\u4EFD"},{name:"DAY",description:"\u8FD4\u56DE\u65E5\u671F\u5728\u4E00\u4E2A\u6708\u4E2D\u7684\u7B2C\u51E0\u5929\u7684\u6570\u503C"},{name:"HOUR",description:"\u8FD4\u56DE\u65E5\u671F\u4E2D\u7684\u5C0F\u65F6\uFF0C\u65E5\u671F\u5B57\u6BB5\u5FC5\u987B\u7CBE\u786E\u5230\u65F6\u95F4\u624D\u53EF\u4EE5\u8BA1\u7B97\u51FA\u6765"},{name:"MINUTE",description:"\u8FD4\u56DE\u65E5\u671F\u4E2D\u7684\u5206\u949F\uFF0C\u65E5\u671F\u5B57\u6BB5\u5FC5\u987B\u7CBE\u786E\u5230\u65F6\u95F4\u624D\u53EF\u4EE5\u8BA1\u7B97\u51FA\u6765"},{name:"SECOND",description:"\u8FD4\u56DE\u65E5\u671F\u4E2D\u7684\u79D2\uFF0C\u65E5\u671F\u5B57\u6BB5\u5FC5\u987B\u7CBE\u786E\u5230\u65F6\u95F4\u624D\u53EF\u4EE5\u8BA1\u7B97\u51FA\u6765"},{name:"DATE",description:"\u5C06\u6570\u5B57\u62FC\u63A5\u6210\u4E3A\u5E74\u4EFD\uFF0C\u6570\u5B57\u5B57\u6BB5\u987A\u5E8F\u4E3A\uFF1A\u5E74\uFF0F\u6708\uFF0F\u65E5\uFF0F\u65F6\uFF0F\u5206\uFF0F\u79D2"},{name:"CURDATE",description:"\u8FD4\u56DE\u5F53\u524D\u65E5\u671F"},{name:"NOW",description:"\u8FD4\u56DE\u5F53\u524D\u65F6\u95F4\uFF0C\u7CBE\u786E\u5230\u65F6/\u5206/\u79D2"},{name:"DAYS",description:"\u8FD4\u56DE\u65E5\u671F\u5B57\u6BB51\u4E0E\u65E5\u671F\u5B57\u6BB52\u7684\u5DEE\u503C\uFF0C\u5355\u4F4D\u4E3A\u5929"},{name:"DATEDELTA",description:"\u5C06\u6307\u5B9A\u65E5\u671F\u52A0/\u51CF\u6307\u5B9A\u5929\u6570\uFF0C\u5E76\u8FD4\u56DE\u76EE\u6807\u65E5\u671F"}]},{name:"\u81EA\u5B9A\u4E49\u51FD\u6570",functions:[{name:"CURRENT_DATE",description:"\u8FD4\u56DE\u5F53\u524D\u65E5\u671F\uFF0C\u683C\u5F0F 2022-01-01"},{name:"CURRENT_TIME",description:"\u8FD4\u56DE\u5F53\u524D\u65F6\u95F4\uFF0C\u683C\u5F0F 18:20:30"},{name:"CURRENT_DATETIME",description:"\u8FD4\u56DE\u5F53\u524D\u65E5\u671F\u65F6\u95F4\uFF0C\u683C\u5F0F 2022-01-01 18:20:30"},{name:"UUID",description:"UUID \u51FD\u6570\u53EF\u4EE5\u7528\u4E8E\u751F\u6210\u968F\u673A\u7801\uFF0C\u9ED8\u8BA4\u7684\u8F93\u51FA\u683C\u5F0F\u4E3A 32 \u4F4D\u5B57\u7B26\u4E32 + 4 \u4E2A\u201C-\u201D\uFF0C\u4E00\u5171 36 \u4F4D\u3002"}]}];function na(l){if(l){var n=P.map(function(g){return g.functions}).reduce(function(g,Z){return g.concat(Z)},[]),f=l.map(function(g){return n.find(function(Z){return Z.name===g})});return[{name:"\u5E38\u7528",functions:f}].concat(P)}return P}var ra=a(76826);function Ma(l){return l==="SplitLine"||l==="Pagination"||l==="Remark"||l==="Signature"||l==="Upload"}function ja(l){return!!["Dept","FillBlank","User","Score","Nps","Textarea"].includes(l)}var Ca=function l(n){var f;(f=n.children)===null||f===void 0||f.forEach(function(g){g.parent=n,l(g)})};function ia(l){if(l.type==="Upload"){var n,f,g=(n=l.children)===null||n===void 0||(f=n[0].attribute)===null||f===void 0?void 0:f.ocrType;if(g==="idCard"){var Z=["\u4F4F\u5740","\u516C\u6C11\u8EAB\u4EFD\u53F7\u7801","\u51FA\u751F","\u59D3\u540D","\u6027\u522B","\u6C11\u65CF","\u5931\u6548\u65E5\u671F","\u7B7E\u53D1\u673A\u5173","\u7B7E\u53D1\u65E5\u671F"];l.children=Z.map(function(S){return{id:"ocr.".concat(S),title:S,type:"Option"}})}}return l}var Pe=function(n,f){var g=function(D){var O,$=(O=D.parent)===null||O===void 0?void 0:O.type;return!($&&["FillBlank","Textarea","Barcode","Nps"].includes($)&&D.id!=="score"||$==="Upload"&&!D.id.startsWith("ocr")||["Pagination"].includes(D.type)||f!=null&&f.fieldTypes&&!f.fieldTypes.includes(D.type)||(f==null?void 0:f.optionVisible)===!1&&(D.type==="Option"||D.type===void 0))},Z=function S(D,O){var $,_,ie=[];return D==null||($=D.children)===null||$===void 0||(_=$.map(function(B){return ia(B)}))===null||_===void 0||_.forEach(function(B,ne){if(B.parent=D,g(B)){var le=O?"".concat(O,".").concat(B.id):B.id,ce={id:B.id,path:le,title:(0,ra.WO)(B.title)||"\u9009\u9879".concat(ne+1),type:B.type,tooltip:B.description,children:B.row?B.row.map(function(H){var V="".concat(B.id,".").concat(H.id),k={id:H.id,path:V,title:H.title,type:B.type,tooltip:H.title,children:S(B,V)};return k}):S(B,le)};ie.push(ce)}}),ie};return Z(n,"")},la=Ue.Z.Link,Oe=function(n){var f=n.title,g=n.subTitle,Z=n.helpLink,S=n.onOk,D=n.value,O=n.className,$=n.onCancel,_=n.fieldAll,ie=n.visible,B=ie===void 0?!0:ie,ne=n.schema,le=n.current,ce=n.functions,H=n.functionVisible,V=n.fieldTypes,k=n.helperVariables,L=n.optionVisible,ee=L===void 0?!0:L,T=(0,C.useRef)(null),w="formula-editor",K=(0,C.useRef)(""),ye=(0,C.useCallback)(function(oe){if(T.current!=null){var ae=T.current.getDoc(),ge=ae.getCursor();ae.replaceRange("".concat(oe,"()"),ge),ge.ch+=oe.length+1,ae.setCursor(ge),T.current.focus()}},[]),Ee=(0,C.useCallback)(function(oe){if(T.current!=null){var ae=T.current.getDoc(),ge=ae.getCursor();ae.replaceRange("#{".concat(K.current).concat(oe.path,"}"),ge,ge),T.current.focus()}},[]),Se=(0,C.useMemo)(function(){return Pe(ne,le,_,V,ee)},[ne,le,_,V]);return(0,e.jsx)(R.Z,{onCancel:$,open:B,maskClosable:!1,getContainer:n.getContainer,title:f,width:1e3,footer:!1,onOk:function(ae){ae.stopPropagation(),S(T.current.getValue())},keyboard:!1,children:(0,e.jsxs)("div",{className:Ne()(w,O),children:[(0,e.jsx)(ya,{functionVisible:H,functions:ce||na(n.commonUseFunctionNames),variables:Se,helperVariables:k,insertFun:ye,insertVariable:Ee}),(0,e.jsxs)("div",{className:"".concat(w,"-main"),children:[(0,e.jsxs)("div",{className:"".concat(w,"-main__code"),children:[(0,e.jsxs)("h1",{children:[(0,e.jsxs)("span",{className:"equle",children:[g,"="]}),(0,e.jsxs)("span",{style:{float:"right"},children:[(0,e.jsx)(we.Z,{title:"\u903B\u8F91\u8868\u793A\u4F7F\u7528\u5177\u4F53\u503C\u53C2\u4E0E\u903B\u8F91\u8BA1\u7B97\uFF0C\u5982\u5355\u9009\u9898\u9009\u4E2D\u4E3A true;\u6587\u672C\u8868\u793A\u4F7F\u7528\u6807\u9898\u53C2\u4E0E\u6587\u672C\u8BA1\u7B97\uFF0C\u5982\u5355\u9009\u9898\u9009\u4E2D\u9009\u9879\u7684\u6587\u672C\u3002",children:(0,e.jsx)($e.Z,{style:{fontSize:16,marginRight:10}})}),(0,e.jsx)(fe.Z,{checkedChildren:"\u903B\u8F91",defaultChecked:!0,unCheckedChildren:"\u6587\u672C",onChange:function(ae){ae?K.current="":K.current="_"}})]})]}),(0,e.jsx)("div",{style:{fontSize:14,color:"#b0b0b9"},children:"\u5728\u5DE6\u4FA7\u9009\u62E9\u51FD\u6570\u6216\u5B57\u6BB5\u53D8\u91CF\uFF0C\u4E14\u5728\u82F1\u6587\u8F93\u5165\u6CD5\u4E0B\u7F16\u8F91"})]}),(0,e.jsx)("div",{className:"".concat(w,"-main__panel"),children:(0,e.jsx)(Re,{ref:T,variable:Se.concat(k||[]),value:D})}),(0,e.jsxs)("div",{className:"".concat(w,"-main__footer"),children:[(0,e.jsxs)(z.Z,{children:[(0,e.jsx)("span",{children:Z}),(0,e.jsx)(la,{href:"https://surveyking.cn/help/logic/formula",target:"_blank",children:"\u516C\u5F0F\u6587\u6863"})]}),(0,e.jsxs)(z.Z,{children:[(0,e.jsx)(A.Z,{onClick:function(){$&&$()},children:"\u53D6\u6D88"}),(0,e.jsx)(A.Z,{type:"primary",onClick:function(ae){ae.stopPropagation(),S(T.current.getValue())},children:"\u786E\u5B9A"})]})]})]})]})})},oa=Oe},71605:function(da,je,a){"use strict";a.r(je),a.d(je,{Data:function(){return Sa},default:function(){return _a}});var u=a(67294),R=a(18111),me=a(11849),A=a(94657),Ze=a(21063),z=a(9761),ca=a(5527),fe=a(11628),fa=a(1013),we=a.n(fa),W=a(42285),Ue=a(71194),ue=a(50146),Ne=a(57663),C=a(71577),he=a(39428),Te=a(3182),ze=a(68068),Ie=a(3980),e=a(85893),Ye=(0,z.Pi)(function(c){var t=c.onCancel,o=(0,u.useContext)(R.xi),i=o.dataStore,r=(0,fe.IE)(),M=r.schema,s=(0,W.YB)(),h=(0,u.useRef)(null),j=(0,u.useRef)(null),p=(0,u.useRef)(new Date().getTime()),d=(0,u.useState)(!1),N=(0,A.Z)(d,2),m=N[0],x=N[1],F=function(){return M?(0,e.jsx)(ze.O,{ref:j,schema:M,headerVisible:!1,paginationVisible:!1,footerVisible:!1,onUpload:i.upload,onDictSearch:function(){var E=(0,Te.Z)((0,he.Z)().mark(function y(Y){var I;return(0,he.Z)().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.next=2,Ie.hi.loadDict(Y);case 2:if(I=X.sent,!I.success){X.next=5;break}return X.abrupt("return",I.data);case 5:return X.abrupt("return",[]);case 6:case"end":return X.stop()}},y)}));return function(y){return E.apply(this,arguments)}}()}):(0,e.jsx)(e.Fragment,{})},Q=function(E){var y;x(!0),(y=j.current)===null||y===void 0||y.submit().then(function(Y){Y?i.saveData({answer:Y.values,attachment:Y.attachments,metaInfo:{answerInfo:{startTime:p.current,endTime:new Date().getTime()}}}).then(function(){p.current=new Date().getTime(),x(!1),i.loadData(),E&&E()}):x(!1)})};return(0,e.jsx)("div",{ref:h,className:"add-data",children:(0,e.jsx)(ue.Z,{open:!0,maskClosable:!1,getContainer:function(){return h.current},title:s.formatMessage({id:"pages.survey.data.addData.title",defaultMessage:"\u6DFB\u52A0\u6570\u636E"}),width:1e3,bodyStyle:{padding:20},onCancel:t,footer:(0,e.jsxs)("div",{className:"footer",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(C.Z,{type:"primary",loading:m,onClick:function(){return Q(t)},children:s.formatMessage({id:"pages.common.submit",defaultMessage:"\u63D0\u4EA4"})}),(0,e.jsx)(C.Z,{onClick:function(){t()},children:s.formatMessage({id:"pages.common.cancel",defaultMessage:"\u53D6\u6D88"})})]}),(0,e.jsx)("div",{children:(0,e.jsx)(C.Z,{loading:m,type:"link",onClick:function(){Q(function(){var E;return(E=j.current)===null||E===void 0?void 0:E.reset()})},children:s.formatMessage({id:"pages.survey.data.addData.submitAndContinue",defaultMessage:"\u63D0\u4EA4\u5E76\u518D\u586B\u4E00\u4EFD"})})})]}),children:(0,e.jsx)("div",{style:{maxHeight:300,overflowY:"auto"},children:F()})})})}),Re=(0,z.Pi)(function(){var c=(0,u.useState)(!1),t=(0,A.Z)(c,2),o=t[0],i=t[1],r=(0,W.YB)();return(0,e.jsxs)("div",{className:"toolbar-item",children:[(0,e.jsxs)("a",{onClick:function(){return i(!0)},children:[(0,e.jsx)(we(),{size:18,style:{cursor:"pointer"}}),r.formatMessage({id:"pages.survey.data.toolbar.add",defaultMessage:"\u6DFB\u52A0\u6570\u636E"})]}),o&&(0,e.jsx)(Ye,{onCancel:function(){return i(!1)}})]})}),$e=a(93756),va=a.n($e),He=(0,z.Pi)(function(){var c=(0,u.useContext)(R.xi),t=c.dataStore;return(0,e.jsx)("div",{className:"toolbar-item",style:{width:45,borderRight:"1px solid #c5c5c5"},children:(0,e.jsx)("a",{onClick:function(){t.loadData()},children:(0,e.jsx)(va(),{size:18,style:{cursor:"pointer"}})})})}),Na=a(34792),se=a(48086),Ke=a(87588),ma=a(82061),We=(0,z.Pi)(function(){var c=(0,u.useContext)(R.xi),t=c.dataStore,o=t.selected,i=(0,u.useRef)(null),r=(0,W.YB)(),M=function(){(o==null?void 0:o.length)===0?se.default.error(r.formatMessage({id:"pages.survey.data.delete.error.noSelection",defaultMessage:"\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u533A\u57DF"})):ue.Z.confirm({title:r.formatMessage({id:"pages.survey.data.delete.title",defaultMessage:"\u5220\u9664\u6570\u636E"}),getContainer:i.current,icon:(0,e.jsx)(Ke.Z,{}),content:(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"delete-content",children:r.formatMessage({id:"pages.survey.data.delete.confirm",defaultMessage:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9 {count} \u6761\u6570\u636E\u5417\uFF1F"},{count:(0,e.jsx)("span",{children:o==null?void 0:o.length})})}),(0,e.jsx)("div",{className:"delete-description",children:r.formatMessage({id:"pages.survey.data.delete.tip",defaultMessage:"\u63D0\u793A\uFF1A\u5220\u9664\u7684\u6570\u636E\u53EF\u4EE5\u5728\u56DE\u6536\u7AD9\u91CC\u9762\u627E\u56DE"})})]}),okText:r.formatMessage({id:"pages.common.delete",defaultMessage:"\u5220\u9664"}),okType:"danger",cancelText:r.formatMessage({id:"pages.common.cancel",defaultMessage:"\u53D6\u6D88"}),onOk:function(){t.deleteData()},onCancel:function(){}})};return(0,e.jsx)("div",{className:"toolbar-item",ref:i,children:(0,e.jsxs)("a",{onClick:M,children:[(0,e.jsx)(ma.Z,{size:18,style:{cursor:"pointer"}}),r.formatMessage({id:"pages.survey.data.delete.trigger",defaultMessage:"\u5220\u9664\u6570\u636E"})]})})}),Ta=a(88983),G=a(66253),ga=a(22385),ve=a(94199),Ge=a(9715),de=a(55246),pa=a(14965),Ce=a(40554),Qe=a(69753),xe=a(63783),ha=a(1997),Xe=function(t){var o=t.value,i=t.onChange,r=(0,fe.IE)(),M=(0,u.useState)(!1),s=(0,A.Z)(M,2),h=s[0],j=s[1],p=(0,W.YB)(),d=r.schema;return(0,e.jsxs)("div",{children:[(0,e.jsx)(C.Z,{type:"link",onClick:function(){return j(!0)},children:p.formatMessage({id:"pages.survey.data.download.formula.select",defaultMessage:"\u70B9\u51FB\u9009\u62E9"})}),d&&(0,e.jsx)(ha.ZP,{visible:h,helpLink:(0,e.jsx)(C.Z,{type:"link",onClick:function(){return window.open("https://surveyking.cn/help/data/export-data#%E5%AF%BC%E5%87%BA%E9%99%84%E4%BB%B6")},children:p.formatMessage({id:"pages.survey.data.download.formula.help",defaultMessage:"\u5982\u4F55\u81EA\u5B9A\u4E49\u5BFC\u51FA"})}),value:o,fieldTypes:["FillBlank","MultipleBlank","Textarea","Select"],title:p.formatMessage({id:"pages.survey.data.download.formula.title",defaultMessage:"\u5BFC\u51FA\u9644\u4EF6\u547D\u540D\u89C4\u5219\u8BBE\u7F6E"}),schema:r.schema,onCancel:function(){return j(!1)},helperVariables:[{id:"sourceName",path:"sourceName",title:p.formatMessage({id:"pages.survey.data.download.formula.option.sourceName",defaultMessage:"\u539F\u59CB\u6587\u4EF6\u540D"}),type:"FillBlank",tooltip:p.formatMessage({id:"pages.survey.data.download.formula.tooltip.sourceName",defaultMessage:"\u9644\u4EF6\u539F\u59CB\u4E0A\u4F20\u7684\u6587\u4EF6\u540D"})},{id:"serialNum",path:"serialNum",title:p.formatMessage({id:"pages.survey.data.download.formula.option.serialNum",defaultMessage:"\u8FDE\u7EED\u5E8F\u53F7"}),type:"FillBlank",tooltip:p.formatMessage({id:"pages.survey.data.download.formula.tooltip.serialNum",defaultMessage:"\u4ECE1\u5F00\u59CB\u7684\u5E8F\u53F7"})},{id:"serialNumInAnswer",path:"serialNumInAnswer",title:p.formatMessage({id:"pages.survey.data.download.formula.option.serialNumInAnswer",defaultMessage:"\u540C\u4E00\u95EE\u5377\u5185\u8FDE\u7EED\u5E8F\u53F7"}),type:"FillBlank",tooltip:p.formatMessage({id:"pages.survey.data.download.formula.tooltip.serialNumInAnswer",defaultMessage:"\u4ECE1\u5F00\u59CB\u7684\u5E8F\u53F7"})},{id:"uploadDateTime",path:"uploadDateTime",title:p.formatMessage({id:"pages.survey.data.download.formula.option.uploadDateTime",defaultMessage:"\u9644\u4EF6\u4E0A\u4F20\u65E5\u671F\u65F6\u95F4"}),type:"FillBlank",tooltip:p.formatMessage({id:"pages.survey.data.download.formula.tooltip.uploadDateTime",defaultMessage:"\u9644\u4EF6\u4E0A\u4F20\u7684\u65E5\u671F\u65F6\u95F4"})},{id:"uploadDate",path:"uploadDate",title:p.formatMessage({id:"pages.survey.data.download.formula.option.uploadDate",defaultMessage:"\u9644\u4EF6\u4E0A\u4F20\u65E5\u671F"}),type:"FillBlank",tooltip:p.formatMessage({id:"pages.survey.data.download.formula.tooltip.uploadDate",defaultMessage:"\u9644\u4EF6\u4E0A\u4F20\u7684\u65E5\u671F"})},{id:"questionTitle",path:"questionTitle",title:p.formatMessage({id:"pages.survey.data.download.formula.option.questionTitle",defaultMessage:"\u9644\u4EF6\u95EE\u9898\u6807\u9898"}),type:"FillBlank",tooltip:p.formatMessage({id:"pages.survey.data.download.formula.tooltip.questionTitle",defaultMessage:"\u9644\u4EF6\u6240\u5C5E\u9898\u76EE\u7684\u6807\u9898"})}],functionVisible:!1,onOk:function(m){j(!1),i&&i(m)}})]})},Je=Ce.Z.RangePicker,qe={labelCol:{span:6},wrapperCol:{span:18}},_e=function(){var t=de.Z.useForm(),o=(0,A.Z)(t,1),i=o[0],r=(0,u.useContext)(R.xi),M=r.dataStore,s=(0,u.useState)(!1),h=(0,A.Z)(s,2),j=h[0],p=h[1],d=(0,u.useState)("answer"),N=(0,A.Z)(d,2),m=N[0],x=N[1],F=(0,u.useState)("source"),Q=(0,A.Z)(F,2),v=Q[0],E=Q[1],y=(0,W.YB)(),Y=function(J){var X,De,Ve=J.exportMode;M.download({type:m,nameExp:J.nameExp,exportMode:Ve,startTime:(X=J.timeScope)===null||X===void 0?void 0:X[0].format("YYYY-MM-DD HH:mm:ss"),endTime:(De=J.timeScope)===null||De===void 0?void 0:De[1].format("YYYY-MM-DD HH:mm:ss")})};return(0,e.jsxs)("div",{className:"toolbar-item",children:[(0,e.jsx)("a",{title:y.formatMessage({id:"pages.survey.data.download.title",defaultMessage:"\u5BFC\u51FA\u6570\u636E"}),onClick:function(){return p(!0)},children:(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(Qe.Z,{}),y.formatMessage({id:"pages.survey.data.download.title",defaultMessage:"\u5BFC\u51FA\u6570\u636E"})]})}),(0,e.jsx)(ue.Z,{title:(0,e.jsxs)("span",{children:[y.formatMessage({id:"pages.survey.data.download.title",defaultMessage:"\u5BFC\u51FA\u6570\u636E"}),(0,e.jsx)(ve.Z,{title:(0,e.jsx)("span",{style:{cursor:"pointer"},onClick:function(){return window.open("https://surveyking.cn/help/data/export-data#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E5%90%8D%E5%AF%BC%E5%87%BA")},children:y.formatMessage({id:"pages.survey.data.download.viewDoc",defaultMessage:"\u67E5\u770B\u6587\u6863"})}),children:(0,e.jsx)(xe.Z,{style:{marginLeft:10}})})]}),open:j,onCancel:function(){return p(!1)},okText:y.formatMessage({id:"pages.common.export",defaultMessage:"\u5BFC\u51FA"}),onOk:function(){Y(i.getFieldsValue())},children:(0,e.jsxs)(de.Z,(0,me.Z)((0,me.Z)({name:"validate_other"},qe),{},{initialValues:{type:"answer",dataType:"excel",atttachNameType:"source",exportMode:"all"},form:i,children:[(0,e.jsx)(de.Z.Item,{name:"type",label:y.formatMessage({id:"pages.survey.data.download.field.type",defaultMessage:"\u5BFC\u51FA\u5185\u5BB9"}),children:(0,e.jsxs)(G.ZP.Group,{onChange:function(J){x(J.target.value)},children:[(0,e.jsx)(G.ZP,{value:"answer",children:y.formatMessage({id:"pages.survey.data.download.type.answer",defaultMessage:"\u6570\u636E\u8BE6\u60C5\u8868"})}),(0,e.jsx)(G.ZP,{value:"attachment",children:y.formatMessage({id:"pages.survey.data.download.type.attachment",defaultMessage:"\u7B54\u6848\u9644\u4EF6"})}),(0,e.jsx)(G.ZP,{value:"answerAttachment",children:y.formatMessage({id:"pages.survey.data.download.type.both",defaultMessage:"\u6570\u636E+\u9644\u4EF6"})})]})}),(0,e.jsx)(de.Z.Item,{name:"timeScope",label:y.formatMessage({id:"pages.survey.data.download.field.timeScope",defaultMessage:"\u65F6\u95F4\u6BB5"}),children:(0,e.jsx)(Je,{showTime:!0})}),m==="answer"&&(0,e.jsx)(de.Z.Item,{name:"dataType",label:y.formatMessage({id:"pages.survey.data.download.field.dataType",defaultMessage:"\u5BFC\u51FA\u683C\u5F0F"}),children:(0,e.jsx)(G.ZP.Group,{children:(0,e.jsx)(G.ZP,{value:"excel",children:"Excel(.xlsx)"})})}),(m==="attachment"||m==="answerAttachment")&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(de.Z.Item,{name:"atttachNameType",label:y.formatMessage({id:"pages.survey.data.download.field.attachmentName",defaultMessage:"\u9644\u4EF6\u547D\u540D"}),children:(0,e.jsxs)(G.ZP.Group,{onChange:function(J){return E(J.target.value)},children:[(0,e.jsx)(G.ZP,{value:"source",children:y.formatMessage({id:"pages.survey.data.download.attachmentName.source",defaultMessage:"\u539F\u59CB\u6587\u4EF6\u540D"})}),(0,e.jsx)(G.ZP,{value:"byField",children:y.formatMessage({id:"pages.survey.data.download.attachmentName.byField",defaultMessage:"\u901A\u8FC7\u586B\u5199\u7684\u5185\u5BB9\u547D\u540D"})})]})}),v==="byField"&&(0,e.jsx)(de.Z.Item,{name:"nameExp",label:y.formatMessage({id:"pages.survey.data.download.field.mapping",defaultMessage:"\u5173\u8054\u5B57\u6BB5"}),children:(0,e.jsx)(Xe,{})})]}),(0,e.jsx)(de.Z.Item,{name:"exportMode",label:y.formatMessage({id:"pages.survey.data.download.field.mode",defaultMessage:"\u5BFC\u51FA\u6A21\u5F0F"}),children:(0,e.jsxs)(G.ZP.Group,{children:[(0,e.jsx)(G.ZP,{value:"all",children:y.formatMessage({id:"pages.survey.data.download.mode.all",defaultMessage:"\u5168\u91CF\u5BFC\u51FA"})}),(0,e.jsx)(G.ZP,{value:"current",children:y.formatMessage({id:"pages.survey.data.download.mode.current",defaultMessage:"\u5BFC\u51FA\u5F53\u524D\u9875"})}),(0,e.jsx)(G.ZP,{value:"selected",children:y.formatMessage({id:"pages.survey.data.download.mode.selected",defaultMessage:"\u5BFC\u51FA\u9009\u4E2D"})})]})})]}))})]})},Be=a(14098),ea=a.n(Be),aa=a(49111),be=a(19650),Ia=a(57338),Ae=a(273),xa=a(62350),ta=a(24565),ya=a(13062),q=a(71230),sa=a(89032),P=a(15746),na=a(7945),ra=a(21444),Ma=a(38296),ja=a(28508),Ca=a(64029),ia=a(34804),Pe=a(47116),la=a.n(Pe),Oe=a(27400),oa=a(94184),l=a.n(oa),n=a(24843),f=a(30037),g=a.n(f),Z=(0,z.Pi)(function(){var c=(0,u.useContext)(R.xi),t=c.dataStore,o=(0,fe.IE)(),i=o.schema,r=(0,Oe.a)(),M=r.isMobile,s=(0,W.YB)(),h=(0,u.useRef)(null),j=(0,u.useRef)(null),p=(0,n.A)("-edit"),d=t.currentIndex,N=(0,u.useRef)(0),m=t.records.length||0,x=t.records[d],F=x.metaInfo,Q=(0,u.useState)(!0),v=(0,A.Z)(Q,2),E=v[0],y=v[1],Y=(0,u.useState)(!1),I=(0,A.Z)(Y,2),J=I[0],X=I[1],De=(0,u.useState)(!1),Ve=(0,A.Z)(De,2),et=Ve[0],Fa=Ve[1],Fe=s.formatMessage({id:"pages.common.none",defaultMessage:"\u65E0"});(0,u.useEffect)(function(){var b,U=x.answer,te=x.attachment;(b=j.current)===null||b===void 0||b.setValues(U,te)},[x]),(0,u.useEffect)(function(){var b;(b=j.current)===null||b===void 0||b.toggleReadOnly(E)},[E]),(0,u.useEffect)(function(){N.current=d},[d]),(0,u.useEffect)(function(){var b=function(re){if(N.current===m-1){se.default.warn({content:s.formatMessage({id:"pages.survey.data.detail.message.lastRecord",defaultMessage:"\u5DF2\u662F\u6700\u540E\u4E00\u6761"}),key:"survey-data-last"});return}re.preventDefault(),se.default.success({content:s.formatMessage({id:"pages.survey.data.detail.message.nextRecord",defaultMessage:"\u67E5\u770B\u4E0B\u4E00\u6761"}),key:"survey-data-next"}),ke("down")},U=function(re){if(re.preventDefault(),N.current===0){se.default.warn({content:s.formatMessage({id:"pages.survey.data.detail.message.firstRecord",defaultMessage:"\u5DF2\u662F\u7B2C\u4E00\u6761"}),key:"survey-data-first"});return}se.default.success({content:s.formatMessage({id:"pages.survey.data.detail.message.previousRecord",defaultMessage:"\u67E5\u770B\u4E0A\u4E00\u6761"}),key:"survey-data-prev"}),ke("up")};return g()("down",b),g()("up",U),function(){g().unbind("down",b),g().unbind("up",U)}},[s,m]);var at=function(){t.currentIndex=-1},tt=function(){return i||x.survey?(0,e.jsx)(ze.O,{ref:j,schema:x.survey||i,headerVisible:!1,footerVisible:!1,paginationVisible:!1,questionNumber:!1,requiredVisible:!1,readOnly:E,onUpload:t.upload,onDictSearch:function(){var U=(0,Te.Z)((0,he.Z)().mark(function te(re){var Me;return(0,he.Z)().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return pe.next=2,Ie.hi.loadDict(re);case 2:if(Me=pe.sent,!Me.success){pe.next=5;break}return pe.abrupt("return",Me.data);case 5:return pe.abrupt("return",[]);case 6:case"end":return pe.stop()}},te)}));return function(te){return U.apply(this,arguments)}}()}):(0,e.jsx)(e.Fragment,{})},ke=function(U){U==="up"?t.currentIndex=t.currentIndex-1:t.currentIndex=t.currentIndex+1,N.current=t.currentIndex},st=function(){var U,te,re,Me;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(q.Z,{children:[(0,e.jsx)(P.Z,{span:8,children:s.formatMessage({id:"pages.survey.data.detail.meta.index",defaultMessage:"\u5E8F\u53F7:"})}),(0,e.jsx)(P.Z,{span:16,children:d+1})]}),(0,e.jsxs)(q.Z,{children:[(0,e.jsx)(P.Z,{span:8,children:s.formatMessage({id:"pages.survey.data.detail.meta.submitter",defaultMessage:"\u63D0\u4EA4\u4EBA:"})}),(0,e.jsx)(P.Z,{span:16,children:x.createByName||Fe})]}),F&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(q.Z,{children:[(0,e.jsx)(P.Z,{span:8,children:s.formatMessage({id:"pages.survey.data.detail.meta.duration",defaultMessage:"\u7B54\u5377\u65F6\u957F:"})}),(0,e.jsx)(P.Z,{span:16,children:(0,R.gh)(F.answerInfo.endTime-F.answerInfo.startTime)})]}),(0,e.jsxs)(q.Z,{children:[(0,e.jsx)(P.Z,{span:8,children:s.formatMessage({id:"pages.survey.data.detail.meta.submittedAt",defaultMessage:"\u63D0\u4EA4\u65F6\u95F4:"})}),(0,e.jsx)(P.Z,{span:16,children:x.createAt})]}),(0,e.jsxs)(q.Z,{children:[(0,e.jsx)(P.Z,{span:8,children:s.formatMessage({id:"pages.survey.data.detail.meta.updatedAt",defaultMessage:"\u4FEE\u6539\u65F6\u95F4:"})}),(0,e.jsx)(P.Z,{span:16,children:x.updateAt||"-"})]}),(0,e.jsxs)(q.Z,{children:[(0,e.jsx)(P.Z,{span:8,children:s.formatMessage({id:"pages.survey.data.detail.meta.device",defaultMessage:"\u586B\u5199\u8BBE\u5907:"})}),(0,e.jsx)(P.Z,{span:16,children:((U=F.clientInfo)===null||U===void 0?void 0:U.deviceType)||Fe})]}),(0,e.jsxs)(q.Z,{children:[(0,e.jsx)(P.Z,{span:8,children:s.formatMessage({id:"pages.survey.data.detail.meta.os",defaultMessage:"\u64CD\u4F5C\u7CFB\u7EDF:"})}),(0,e.jsx)(P.Z,{span:16,children:((te=F.clientInfo)===null||te===void 0?void 0:te.platform)||Fe})]}),(0,e.jsxs)(q.Z,{children:[(0,e.jsx)(P.Z,{span:8,children:s.formatMessage({id:"pages.survey.data.detail.meta.browser",defaultMessage:"\u6D4F\u89C8\u5668:"})}),(0,e.jsx)(P.Z,{span:16,children:((re=F.clientInfo)===null||re===void 0?void 0:re.browser)||Fe})]}),(0,e.jsxs)(q.Z,{children:[(0,e.jsx)(P.Z,{span:8,children:s.formatMessage({id:"pages.survey.data.detail.meta.ip",defaultMessage:"IP:"})}),(0,e.jsx)(P.Z,{span:16,children:((Me=F.clientInfo)===null||Me===void 0?void 0:Me.remoteIp)||Fe})]})]})]})},nt=function(){var U;return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{style:{textAlign:"left",color:"#767c85"},children:[(0,e.jsx)("span",{children:s.formatMessage({id:"pages.survey.data.detail.simpleSubmitter",defaultMessage:"\u63D0\u4EA4\u8005\uFF1A{name}\uFF08{date}\uFF09"},{name:x.createByName||Fe,date:x.createAt})}),(0,e.jsx)("div",{style:{textAlign:"center",color:"#3d4757",fontSize:20},children:(U=o.project)===null||U===void 0?void 0:U.name})]})})},rt=function(){return E?(0,e.jsxs)("div",{children:[(0,e.jsx)(C.Z,{type:"primary",onClick:function(){return y(!1)},children:s.formatMessage({id:"pages.survey.data.detail.edit",defaultMessage:"\u4FEE\u6539"})}),(0,e.jsx)(C.Z,{type:"primary",danger:!0,style:{marginLeft:5},children:(0,e.jsx)(ta.Z,{title:s.formatMessage({id:"pages.survey.data.detail.deleteConfirm",defaultMessage:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u6761\u6570\u636E\u5417\uFF1F"}),icon:(0,e.jsx)(xe.Z,{style:{color:"red"}}),okText:s.formatMessage({id:"pages.common.delete",defaultMessage:"\u5220\u9664"}),cancelText:s.formatMessage({id:"pages.common.cancel",defaultMessage:"\u53D6\u6D88"}),onConfirm:function(){t.deleteData(d).then(function(){return at()})},children:(0,e.jsx)("span",{children:s.formatMessage({id:"pages.common.delete",defaultMessage:"\u5220\u9664"})})})}),(0,e.jsx)(C.Z,{type:"link",style:{marginLeft:5},onClick:function(){return Fa(!0)},children:s.formatMessage({id:"pages.survey.data.detail.more",defaultMessage:"\u8BE6\u60C5"})}),(0,e.jsx)(Ae.Z,{placement:"right",autoFocus:!1,open:et,onClose:function(){return Fa(!1)},children:st()})]}):(0,e.jsxs)("div",{children:[(0,e.jsx)(C.Z,{type:"primary",loading:J,onClick:function(){var te;X(!0),(te=j.current)===null||te===void 0||te.submit().then(function(re){re?t.updateData({answer:re.values,attachment:re.attachments,id:x.id,projectId:x.projectId}).then(function(){X(!1),y(!0)}):X(!1)})},children:s.formatMessage({id:"pages.common.submit",defaultMessage:"\u63D0\u4EA4"})}),(0,e.jsx)(C.Z,{style:{marginLeft:10},onClick:function(){return y(!0)},children:s.formatMessage({id:"pages.common.cancel",defaultMessage:"\u53D6\u6D88"})})]})},it=(0,u.useState)(!1),Za=(0,A.Z)(it,2),Le=Za[0],Ea=Za[1],Da=(0,u.useRef)();return(0,e.jsx)("div",{ref:h,className:"edit-data ".concat(p),children:(0,e.jsx)(ue.Z,{open:d>=0,maskClosable:!1,title:!1,width:Le?void 0:750,onCancel:function(){return t.currentIndex=-1},footer:!1,closable:!1,bodyStyle:{padding:0},children:(0,e.jsx)(q.Z,{gutter:16,style:Le?{position:"fixed",top:0,bottom:0,left:0,right:0,background:"white"}:{paddingRight:0},children:(0,e.jsxs)(P.Z,{xs:24,sm:24,className:p+"-survey-container",children:[(0,e.jsxs)("div",{className:p+"-survey-container-title",children:[s.formatMessage({id:"pages.survey.data.detail.title",defaultMessage:"\u6570\u636E\u8BE6\u60C5"}),(0,e.jsxs)(be.Z,{style:{marginRight:20},children:[(0,e.jsx)(la(),{trigger:function(){return(0,e.jsx)(ve.Z,{title:s.formatMessage({id:"pages.survey.data.detail.tooltip.print",defaultMessage:"\u6253\u5370\u672C\u6761\u6570\u636E"}),children:(0,e.jsx)(C.Z,{type:"text",icon:(0,e.jsx)(na.Z,{style:{color:"#0265FF"}})})})},content:function(){return Da.current}}),Le&&(0,e.jsx)(ve.Z,{title:s.formatMessage({id:"pages.survey.data.detail.tooltip.exitFullscreen",defaultMessage:"\u9000\u51FA\u5168\u5C4F"}),children:(0,e.jsx)(C.Z,{type:"text",icon:(0,e.jsx)(ra.Z,{style:{color:"#0265FF"}}),onClick:function(){return Ea(!1)}})}),!Le&&(0,e.jsx)(ve.Z,{title:s.formatMessage({id:"pages.survey.data.detail.tooltip.enterFullscreen",defaultMessage:"\u6253\u5F00\u5168\u5C4F"}),children:(0,e.jsx)(C.Z,{type:"text",icon:(0,e.jsx)(Ma.Z,{style:{color:"#0265FF"}}),onClick:function(){return Ea(!0)}})}),(0,e.jsx)(C.Z,{type:"text",icon:(0,e.jsx)(ja.Z,{style:{color:"#0265FF"}}),onClick:function(){t.currentIndex=-1}})]})]}),(0,e.jsxs)("div",{className:l()(p+"-survey-container-content","survey"),id:"section-to-print",ref:Da,children:[nt(),tt()]}),(0,e.jsxs)("div",{className:p+"-survey-container-footer",children:[rt(),(0,e.jsxs)("div",{className:"nav",children:[(0,e.jsxs)("span",{children:[d+1,"/",m]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(ve.Z,{title:s.formatMessage({id:"pages.survey.data.detail.tooltip.prevRecord",defaultMessage:"\u67E5\u770B\u4E0A\u4E00\u6761\u6570\u636E\uFF0C\u5FEB\u6377\u952E\u300C\u2191\u300D"}),children:(0,e.jsx)(C.Z,{type:"text",shape:"circle",icon:(0,e.jsx)(Ca.Z,{}),disabled:d===0,onClick:function(){return ke("up")}})}),(0,e.jsx)(ve.Z,{title:s.formatMessage({id:"pages.survey.data.detail.tooltip.nextRecord",defaultMessage:"\u67E5\u770B\u4E0B\u4E00\u6761\u6570\u636E\uFF0C\u5FEB\u6377\u952E\u300C\u2193\u300D"}),children:(0,e.jsx)(C.Z,{type:"text",shape:"circle",icon:(0,e.jsx)(ia.Z,{}),disabled:d===m-1,onClick:function(){return ke("down")}})})]})]})]})]})})})})}),S=(0,z.Pi)(function(){var c=(0,u.useContext)(R.xi),t=c.dataStore,o=t.selected,i=(0,W.YB)();return(0,e.jsxs)("div",{className:"toolbar-item",children:[(0,e.jsxs)("a",{onClick:function(){o&&o.length>0?t.currentIndex=o[0]:se.default.error(i.formatMessage({id:"pages.survey.data.edit.error.noSelection",defaultMessage:"\u8BF7\u70B9\u51FB\u8981\u7F16\u8F91\u7684\u884C"}))},children:[(0,e.jsx)(ea(),{size:14,style:{cursor:"pointer"}}),i.formatMessage({id:"pages.survey.data.edit.trigger",defaultMessage:"\u7F16\u8F91\u6570\u636E"})]}),t.currentIndex!==-1&&(0,e.jsx)(Z,{})]})}),D=a(25769),O=a.n(D),$=(0,z.Pi)(function(){var c=(0,u.useContext)(R.xi),t=c.dataStore,o=(0,W.YB)();return(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{title:o.formatMessage({id:"pages.survey.data.download.attachmentTitle",defaultMessage:"\u5BFC\u51FA\u9644\u4EF6"}),onClick:function(){t.downloadSurveyAttachment()},children:(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(O(),{size:18,style:{cursor:"pointer"}}),o.formatMessage({id:"pages.survey.data.download.attachment",defaultMessage:"\u5BFC\u51FA\u9644\u4EF6"})]})})})}),_=a(72850),ie=function(t){var o=t.onClose,i=(0,u.useContext)(R.xi),r=i.dataStore,M=(0,fe.IE)(),s=M.schema,h=r.deletedRecords||[],j=r.recycleSelected,p=M.mode,d=(0,W.YB)();(0,u.useEffect)(function(){r.loadDeletedData()},[]);var N=(0,u.useMemo)(function(){var m=(0,R.ZZ)(s);return p==="exam"&&m.push({name:"examScore",title:d.formatMessage({id:"pages.survey.data.column.examScore",defaultMessage:"\u5206\u6570"}),width:100}),m.push({name:"startTime",title:d.formatMessage({id:"pages.survey.data.column.startTime",defaultMessage:"\u5F00\u59CB\u65F6\u95F4"}),width:180}),m.push({name:"endTime",title:d.formatMessage({id:"pages.survey.data.column.endTime",defaultMessage:"\u63D0\u4EA4\u65F6\u95F4"}),width:180}),m.push({name:"totalTime",title:d.formatMessage({id:"pages.survey.data.column.totalTime",defaultMessage:"\u7B54\u9898\u65F6\u957F"})}),m.push({name:"createByName",title:d.formatMessage({id:"pages.survey.data.column.submitter",defaultMessage:"\u63D0\u4EA4\u4EBA"}),width:180}),m.push({name:"remoteIp",title:d.formatMessage({id:"pages.survey.data.column.ip",defaultMessage:"IP\u5730\u5740"})}),m.push({name:"browserType",title:d.formatMessage({id:"pages.survey.data.column.browser",defaultMessage:"\u6D4F\u89C8\u5668"})}),m.push({name:"deviceType",title:d.formatMessage({id:"pages.survey.data.column.deviceType",defaultMessage:"\u8BBE\u5907\u7C7B\u578B"})}),m.push({name:"platform",title:d.formatMessage({id:"pages.survey.data.column.platform",defaultMessage:"\u5E73\u53F0\u7C7B\u578B"})}),m},[s,p,d]);return(0,e.jsx)(ue.Z,{open:!0,onCancel:o,width:800,bodyStyle:{padding:20},closable:!1,title:d.formatMessage({id:"pages.survey.data.recycle.title",defaultMessage:"\u56DE\u6536\u7AD9"}),footer:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{float:"left"},children:d.formatMessage({id:"pages.survey.data.recycle.selected",defaultMessage:"\u5DF2\u9009\u4E2D {count} \u6761"},{count:(j==null?void 0:j.length)||0})}),(0,e.jsxs)(be.Z,{children:[(0,e.jsx)(C.Z,{onClick:o,children:d.formatMessage({id:"pages.common.cancel",defaultMessage:"\u53D6\u6D88"})}),(0,e.jsx)(C.Z,{type:"primary",danger:!0,onClick:function(){var x;if(((x=r.recycleSelected)===null||x===void 0?void 0:x.length)===0){se.default.error(d.formatMessage({id:"pages.survey.data.recycle.error.noDeleteSelection",defaultMessage:"\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u6570\u636E"}));return}ue.Z.confirm({title:d.formatMessage({id:"pages.survey.data.recycle.delete.title",defaultMessage:"\u5F7B\u5E95\u5220\u9664"}),content:d.formatMessage({id:"pages.survey.data.recycle.delete.content",defaultMessage:"\u5F7B\u5E95\u5220\u9664\u4E4B\u540E\uFF0C\u8BE5\u6570\u636E\u5C31\u627E\u4E0D\u56DE\u6765\u4E86\uFF0C\u4ECD\u7136\u786E\u5B9A\u8FD9\u6837\u505A\u5417?"}),okText:d.formatMessage({id:"pages.common.ok",defaultMessage:"\u786E\u5B9A"}),okType:"danger",cancelText:d.formatMessage({id:"pages.common.cancel",defaultMessage:"\u53D6\u6D88"}),onOk:function(){r.physicalDeleteData()}})},children:d.formatMessage({id:"pages.survey.data.recycle.delete.action",defaultMessage:"\u5F7B\u5E95\u5220\u9664"})}),(0,e.jsx)(C.Z,{type:"primary",onClick:function(){var x;if(((x=r.recycleSelected)===null||x===void 0?void 0:x.length)===0){se.default.info(d.formatMessage({id:"pages.survey.data.recycle.error.noRestoreSelection",defaultMessage:"\u8BF7\u9009\u62E9\u8981\u6062\u590D\u7684\u6570\u636E"}));return}ue.Z.confirm({title:d.formatMessage({id:"pages.survey.data.recycle.restore.title",defaultMessage:"\u6062\u590D\u6570\u636E"}),content:d.formatMessage({id:"pages.survey.data.recycle.restore.content",defaultMessage:"\u786E\u8BA4\u5C06\u9009\u4E2D\u7684\u6570\u636E\u4ECE\u56DE\u6536\u7AD9\u6062\u590D\u5417?"}),okText:d.formatMessage({id:"pages.common.ok",defaultMessage:"\u786E\u5B9A"}),cancelText:d.formatMessage({id:"pages.common.cancel",defaultMessage:"\u53D6\u6D88"}),onOk:function(){r.restoreData()}})},children:d.formatMessage({id:"pages.survey.data.recycle.restore.action",defaultMessage:"\u6062\u590D"})})]})]}),children:(0,e.jsx)(Ze._$,{editable:!1,height:450,width:730,selectionMode:"cell",allowSorting:!0,schema:N,data:(0,R.IR)(h,N),onSelect:function(x){r.recycleSelected=x.filter(function(F){return F}).map(function(F){return F._i})}})})},B=(0,z.Pi)(ie),ne=(0,z.Pi)(function(){var c=(0,u.useRef)(null),t=(0,u.useState)(!1),o=(0,A.Z)(t,2),i=o[0],r=o[1],M=(0,u.useContext)(R.xi),s=M.dataStore,h=(0,W.YB)();return(0,e.jsxs)("div",{className:"toolbar-item",ref:c,style:{width:80,borderRight:"1px solid #c5c5c5"},children:[(0,e.jsxs)("a",{onClick:function(){return r(!0)},children:[(0,e.jsx)(_.Z,{size:18,style:{cursor:"pointer"}}),h.formatMessage({id:"pages.survey.data.recycle.trigger",defaultMessage:"\u56DE\u6536\u7AD9"})]}),i&&(0,e.jsx)(B,{onClose:function(){r(!1),s.loadData()}})]})}),le=(0,z.Pi)(function(){return(0,e.jsx)("div",{className:"toolbar-item",style:{width:45,borderRight:"1px solid #c5c5c5"},children:(0,e.jsx)("a",{onClick:function(){window.open("https://surveyking.cn/help/data")},children:(0,e.jsx)(xe.Z,{size:18,style:{cursor:"pointer"}})})})}),ce=a(59250),H=a(13013),V=a(30887),k=a(28682),L=a(77883),ee=a(48592),T=a(14603),w=a.n(T),K=a(83434),ye=a.n(K),Ee=a(53758),Se=a.n(Ee),oe=a(41198),ae=a.n(oe),ge=a(34994),Ra=a.n(ge),Ba=(0,z.Pi)(function(){var c=(0,u.useContext)(R.xi),t=c.dataStore,o=t.pagination,i=o.total,r=o.current,M=o.pageSize,s=(0,u.useRef)(M),h=(0,W.YB)(),j="showAll",p="customPageSize",d=h.formatMessage({id:"pages.survey.data.pagination.showAll",defaultMessage:"\u663E\u793A\u6240\u6709"}),N=h.formatMessage({id:"pages.survey.data.pagination.custom",defaultMessage:"\u81EA\u5B9A\u4E49\u9875\u7801"}),m=Math.ceil(i/M);M<=0&&(m=1);var x=(r-1)*M+1,F=r*M;(F<=0||F>i)&&(F=i);var Q=function(E){typeof E=="number"?t.loadData({current:r,pageSize:E,total:i}):E===j?t.loadData({current:r,pageSize:-1,total:i}):E===p&&ue.Z.confirm({icon:null,content:(0,e.jsx)(de.Z.Item,{label:h.formatMessage({id:"pages.survey.data.pagination.custom.label",defaultMessage:"\u81EA\u5B9A\u4E49\u9875\u7801"}),children:(0,e.jsx)(ee.Z,{style:{width:200},defaultValue:M,onChange:function(Y){s.current=Y}})}),okText:h.formatMessage({id:"pages.common.ok",defaultMessage:"\u786E\u5B9A"}),cancelText:h.formatMessage({id:"pages.common.cancel",defaultMessage:"\u53D6\u6D88"}),onOk:function(){t.loadData({current:r,pageSize:s.current,total:i})}})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"toolbar-item",style:{borderLeft:"1px solid #d3cfcf"},children:(0,e.jsx)("a",{className:r===1?"disabled":"",title:h.formatMessage({id:"pages.survey.data.pagination.first",defaultMessage:"\u7B2C\u4E00\u9875"}),onClick:function(){r>1&&t.loadData({current:1,pageSize:M,total:i})},children:(0,e.jsx)(w(),{size:18,style:{cursor:"pointer"}})})}),(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{className:r===1?"disabled":"",onClick:function(){r>1&&t.loadData({current:r-1,pageSize:M,total:i})},title:h.formatMessage({id:"pages.survey.data.pagination.previous",defaultMessage:"\u4E0A\u4E00\u9875"}),children:(0,e.jsx)(ae(),{size:18,style:{cursor:"pointer"}})})}),(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{title:h.formatMessage({id:"pages.survey.data.pagination.pageSet",defaultMessage:"\u5206\u9875\u8BBE\u7F6E"}),children:(0,e.jsx)(H.Z,{trigger:["click"],placement:"top",overlay:(0,e.jsx)(k.Z,{style:{minWidth:80,padding:0},items:[20,50,100,500,1e3,j,p].map(function(v){return{label:typeof v=="number"?v:v===j?d:N,key:v.toString(),onClick:function(){return Q(v)},style:{padding:"0 1em"}}})}),children:(0,e.jsxs)("span",{style:{display:"flex",width:65,justifyContent:"center",alignItems:"center"},children:[i===0?h.formatMessage({id:"pages.survey.data.pagination.empty",defaultMessage:"0 \u884C"}):h.formatMessage({id:"pages.survey.data.pagination.range",defaultMessage:"{start}-{end}"},{start:x,end:F}),(0,e.jsx)(Ra(),{size:18,style:{cursor:"pointer"}})]})})})}),i>0&&(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{onClick:function(){t.loadData()},title:h.formatMessage({id:"pages.survey.data.pagination.refresh",defaultMessage:"\u5237\u65B0\u603B\u6570"}),children:(0,e.jsx)("span",{style:{lineHeight:"16px"},children:h.formatMessage({id:"pages.survey.data.pagination.total",defaultMessage:"\u5171 {total}"},{total:i})})})}),(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{className:r===m?"disabled":"",onClick:function(){r<m&&t.loadData({current:r+1,pageSize:M,total:i})},title:h.formatMessage({id:"pages.survey.data.pagination.next",defaultMessage:"\u4E0B\u4E00\u9875"}),children:(0,e.jsx)(Se(),{size:18,style:{cursor:"pointer"}})})}),(0,e.jsx)("div",{className:"toolbar-item",style:{borderRight:"1px solid #d3cfcf"},children:(0,e.jsx)("a",{className:r===m?"disabled":"",onClick:function(){r<m&&t.loadData({current:M,pageSize:M,total:i})},title:h.formatMessage({id:"pages.survey.data.pagination.last",defaultMessage:"\u6700\u540E\u4E00\u9875"}),children:(0,e.jsx)(ye(),{size:18,style:{cursor:"pointer"}})})})]})});function lt(c){return typeof c!="string"?!1:!isNaN(c)&&!isNaN(parseFloat(c))}var ba=(0,z.Pi)(function(){var c,t=(0,u.useContext)(R.xi),o=t.dataStore,i=((c=o.selected)===null||c===void 0?void 0:c.length)||0,r=(0,W.YB)(),M=function(){var h,j=[],p=0;if((h=o.selectedData)===null||h===void 0||h.forEach(function(m){var x;!m||(x=Object.keys(m))===null||x===void 0||x.forEach(function(F){if(F!=="_i"){p++;var Q=Number(m[F]);isNaN(Q)||j.push(Q)}})}),j.length===0)return(0,e.jsx)(e.Fragment,{});var d=j.reduce(function(m,x){return m+x},0),N=(d/j.length||0).toFixed(0);return(0,e.jsx)("div",{className:"statistics_wrap",children:(0,e.jsx)("span",{children:r.formatMessage({id:"pages.survey.data.selected.statistics",defaultMessage:"\u6C42\u548C={sum} \u5E73\u5747\u503C={avg} \u8BA1\u6570={total}"},{sum:d,avg:N,total:p})})})};return(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsxs)("a",{children:[r.formatMessage({id:"pages.survey.data.selected.count",defaultMessage:"\u5DF2\u9009\u4E2D {count} \u6761"},{count:i})," ",M()]})})}),ot=a(38979),Aa=a(98243),Pa=function(){var t=(0,W.YB)(),o=[{emoji:"\u{1F609}",id:"pages.survey.data.tips.doubleClick",defaultMessage:"\u53CC\u51FB\u5355\u5143\u683C\u7F16\u8F91\u95EE\u5377"},{emoji:"\u{1F920}",id:"pages.survey.data.tips.contextMenu",defaultMessage:"\u53F3\u952E\u5355\u5143\u683C\u4E5F\u6709\u5F88\u591A\u529F\u80FD"},{emoji:"\u{1F60B}",id:"pages.survey.data.tips.freeze",defaultMessage:"\u53F3\u952E\u5355\u5143\u683C\u53EF\u4EE5\u51BB\u7ED3\u7A97\u683C"},{emoji:"\u{1F917}",id:"pages.survey.data.tips.pagination",defaultMessage:"\u652F\u6301\u81EA\u5B9A\u4E49\u5206\u9875"},{emoji:"\u{1F913}",id:"pages.survey.data.tips.filter",defaultMessage:"\u53F3\u952E\u5355\u5143\u683C\u53EF\u4EE5\u8FC7\u6EE4\u884C"}];return(0,e.jsx)("div",{className:"toolbar-item tips",children:(0,e.jsx)(Aa.Z,{dots:!1,dotPosition:"left",autoplay:!0,children:o.map(function(i){return(0,e.jsxs)("div",{className:"tip",children:[i.emoji," ",t.formatMessage({id:i.id,defaultMessage:i.defaultMessage})]},i.id)})})})},Oa=a(80582);function ua(c){return Math.round(c*100)/100}function Va(c){if(c<1024)return"".concat(ua(c),"b");if(c<=1024*1024)return"".concat(ua(c/1024),"Kb");if(c<=1024*1024*1024)return"".concat(ua(c/1024/1024),"Mb")}var ka=(0,Oa.Pi)(function(){var c=(0,n.a)(),t=c.progress;return typeof t!="number"?(0,e.jsx)(e.Fragment,{}):(0,e.jsx)("div",{className:"toolbar-item progress-bar",children:(0,e.jsx)("div",{"aria-valuemin":0,className:"bp3-progress-bar bp3-intent-primary",role:"progressbar",children:(0,e.jsx)("div",{className:"bp3-progress-meter",children:Va(t)})})})}),La=a(11949),wa=a.n(La),Ua=function(t){var o=t.files,i=t.onClose,r=(0,u.useRef)(),M=o.filter(function(s){var h=s.originalName.substring(s.originalName.lastIndexOf(".")+1).toLowerCase();return!!["png","jpg","jpeg","bmp","webp","gif","tif"].includes(h)});return(0,u.useEffect)(function(){if(r.current){var s=new(wa())(r.current,{viewed:function(){},hidden:function(){i()}});s.show()}},[o]),(0,e.jsx)("div",{ref:r,children:M.map(function(s){return(0,e.jsx)("img",{style:{display:"none"},src:"/api/public/preview/".concat(s.id)},s.id)})})},za=Ua,Ya=function(t){var o=t.cell,i=t.onClose;return o.type==="image"&&o.value instanceof Array?(0,e.jsx)(za,{files:o.value,onClose:i}):(0,e.jsx)(e.Fragment,{})},ut=a(17462),$a=a(76772),Ha=a(84391),Ka=a(43347),Wa=a(58602),Ga=function(){var t=(0,u.useState)(!1),o=(0,A.Z)(t,2),i=o[0],r=o[1],M=(0,u.useState)(!1),s=(0,A.Z)(M,2),h=s[0],j=s[1],p=(0,u.useState)([]),d=(0,A.Z)(p,2),N=d[0],m=d[1],x=(0,fe.IE)(),F=(0,u.useContext)(R.xi),Q=F.dataStore,v=(0,W.YB)(),E={multiple:!1,accept:".xlsx",beforeUpload:function(Y){return m([Y]),!1},onRemove:function(){m([])},maxCount:1};return(0,e.jsxs)("div",{className:"toolbar-item",children:[(0,e.jsx)("a",{title:v.formatMessage({id:"pages.survey.data.upload.title",defaultMessage:"\u5BFC\u5165\u6570\u636E"}),onClick:function(){return r(!0)},children:(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(Ha.Z,{}),v.formatMessage({id:"pages.survey.data.upload.title",defaultMessage:"\u5BFC\u5165\u6570\u636E"})]})}),(0,e.jsxs)(ue.Z,{confirmLoading:h,title:(0,e.jsxs)("span",{children:[v.formatMessage({id:"pages.survey.data.upload.title",defaultMessage:"\u5BFC\u5165\u6570\u636E"}),(0,e.jsx)(ve.Z,{title:(0,e.jsx)("span",{style:{cursor:"pointer"},onClick:function(){return window.open("https://surveyking.cn/help/data")},children:v.formatMessage({id:"pages.survey.data.upload.viewDoc",defaultMessage:"\u67E5\u770B\u6587\u6863"})}),children:(0,e.jsx)(xe.Z,{style:{marginLeft:10}})})]}),open:i,onCancel:function(){return r(!1)},okText:v.formatMessage({id:"pages.common.import",defaultMessage:"\u5BFC\u5165"}),onOk:function(){if(N.length===0){se.default.error(v.formatMessage({id:"pages.survey.data.upload.error.noFile",defaultMessage:"\u8BF7\u9009\u62E9\u6587\u4EF6"}));return}j(!0),Ie.hi.upload("/api/answer/upload",{file:N[0],autoSchema:!0,projectId:x.id},function(Y){}).then(function(Y){Y.success?(se.default.success(v.formatMessage({id:"pages.survey.data.upload.success",defaultMessage:"\u5BFC\u5165\u6210\u529F"})),Q.loadData()):se.default.error(Y.message),j(!1)})},children:[(0,e.jsxs)(Wa.Z,(0,me.Z)((0,me.Z)({},E),{},{children:[(0,e.jsx)("p",{className:"ant-upload-drag-icon",children:(0,e.jsx)(Ka.Z,{})}),(0,e.jsx)("p",{className:"ant-upload-text",children:v.formatMessage({id:"pages.common.upload.drag",defaultMessage:"\u70B9\u51FB\u6216\u8005\u62D6\u62FDExcel\u6587\u4EF6\u5230\u6B64\u5904"})})]})),(0,e.jsx)("div",{style:{marginTop:10},children:(0,e.jsx)($a.Z,{message:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{children:v.formatMessage({id:"pages.survey.data.upload.tip.header",defaultMessage:"1. \u5BFC\u5165 Excel \u7684\u7B2C\u4E00\u884C\u4E3A\u6807\u9898\uFF0C\u4E14\u6807\u9898\u5FC5\u987B\u4E0E\u5DF2\u6709\u6570\u636E\u4FDD\u6301\u4E00\u81F4"})}),(0,e.jsx)("div",{children:v.formatMessage({id:"pages.survey.data.upload.tip.support",defaultMessage:"2. \u76EE\u524D\u4EC5\u652F\u6301\u586B\u7A7A\u9898\u7684\u5BFC\u5165"})})]}),type:"info"})})]})]})},Qa=(0,z.Pi)(function(){var c=(0,u.useContext)(R.xi),t=c.dataStore,o=(0,fe.IE)(),i=o.schema,r=t.records||[],M=o.mode,s=(0,W.YB)(),h=(0,u.useState)(),j=(0,A.Z)(h,2),p=j[0],d=j[1],N=(0,u.useMemo)(function(){var v=(0,R.ZZ)(i);return M==="exam"&&v.push({name:"examScore",title:s.formatMessage({id:"pages.survey.data.column.examScore",defaultMessage:"\u5206\u6570"}),width:100,type:"number"}),v.push({name:"openid",title:s.formatMessage({id:"pages.survey.data.column.customField",defaultMessage:"\u81EA\u5B9A\u4E49\u5B57\u6BB5"}),width:120}),v.push({name:"startTime",title:s.formatMessage({id:"pages.survey.data.column.startTime",defaultMessage:"\u5F00\u59CB\u65F6\u95F4"}),width:180}),v.push({name:"endTime",title:s.formatMessage({id:"pages.survey.data.column.endTime",defaultMessage:"\u63D0\u4EA4\u65F6\u95F4"}),width:180}),v.push({name:"totalTime",title:s.formatMessage({id:"pages.survey.data.column.totalTime",defaultMessage:"\u7B54\u9898\u65F6\u957F"})}),v.push({name:"createByName",title:s.formatMessage({id:"pages.survey.data.column.submitter",defaultMessage:"\u63D0\u4EA4\u4EBA"}),width:180}),v.push({name:"remoteIp",title:s.formatMessage({id:"pages.survey.data.column.ip",defaultMessage:"IP\u5730\u5740"})}),v.push({name:"browserType",title:s.formatMessage({id:"pages.survey.data.column.browser",defaultMessage:"\u6D4F\u89C8\u5668"})}),v.push({name:"deviceType",title:s.formatMessage({id:"pages.survey.data.column.deviceType",defaultMessage:"\u8BBE\u5907\u7C7B\u578B"})}),v.push({name:"platform",title:s.formatMessage({id:"pages.survey.data.column.platform",defaultMessage:"\u5E73\u53F0\u7C7B\u578B"})}),v},[i,M,s]),m=(0,u.useState)({width:-1,height:-1}),x=(0,A.Z)(m,2),F=x[0],Q=x[1];return(0,u.useEffect)(function(){i&&t.loadData()},[i]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ca.Z,{bounds:!0,onResize:function(E){E.bounds&&Q(E.bounds)},children:function(E){var y=E.measureRef;return(0,e.jsx)("div",{className:"dataTable-container",ref:y,children:(0,e.jsx)(Ze._$,{editable:!1,height:F.height,width:F.width,selectionMode:"cell",allowSorting:!0,schema:N,data:(0,R.IR)(r,N),onSelect:function(I){t.selectedData=I,t.selected=I==null?void 0:I.filter(function(J){return J}).map(function(J){return J._i})},onClick:function(I){(I.style==="cell"||I.style==="activeCell")&&d({cell:I,visible:!0})},onDoubleClick:function(I){return I.style==="cell"||I.style==="activeCell"?(t.currentIndex=I.data._i,!0):!1}})})}}),p&&p.visible&&(0,e.jsx)(Ya,{cell:p.cell,onClose:function(){return d((0,me.Z)((0,me.Z)({},p),{},{visible:!1}))}})]})}),Xa=function(){return(0,e.jsxs)("div",{className:"toolbar-container",children:[(0,e.jsx)(He,{}),(0,e.jsx)(Re,{}),(0,e.jsx)(S,{}),(0,e.jsx)(We,{}),(0,e.jsx)(_e,{}),(0,e.jsx)(Ga,{}),(0,e.jsx)(ne,{}),(0,e.jsx)(le,{})]})},Ja=function(){return(0,e.jsxs)("div",{className:"statusBar-container",children:[(0,e.jsx)("div",{children:(0,e.jsx)(ba,{})}),(0,e.jsx)("div",{children:(0,e.jsx)(Ba,{})}),(0,e.jsxs)("div",{className:"right-content",children:[(0,e.jsx)(ka,{}),(0,e.jsx)(Pa,{})]})]})},qa=a(23156),Sa=function(){var t=(0,fe.IE)(),o=(0,u.useMemo)(function(){return new qa.Cu(t)},[t]);return(0,e.jsx)(R.fQ,{value:{dataStore:o,prefixCls:"survey-data"},children:(0,e.jsxs)("div",{className:"survey-data",children:[(0,e.jsx)(Xa,{}),(0,e.jsx)(Qa,{}),(0,e.jsx)(Ja,{})]})})},_a=Sa},11628:function(da,je,a){"use strict";a.d(je,{xI:function(){return R},Ge:function(){return Ze},IE:function(){return A}});var u=a(67294),R=(0,u.createContext)({}),me=R.Provider;function A(){var z=(0,u.useContext)(R);return z.store}function Ze(){var z=A();return z.flowStore}}}]);
