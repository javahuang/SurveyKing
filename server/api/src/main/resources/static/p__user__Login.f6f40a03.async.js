(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[9531],{34687:function(N){N.exports={container:"container___1sYa-",lang:"lang___l6cji",content:"content___2zk1-",top:"top___1C1Zi",header:"header___5xZ3f",logo:"logo___2hXsy",title:"title___1-xuF",desc:"desc___-njyT",main:"main___x4OjT",icon:"icon___rzGKO",other:"other___lLyaU",register:"register___11Twg",prefixIcon:"prefixIcon___23Xrx"}},29791:function(N,P,e){"use strict";var le=e(27400),pe=e(36450),Q=e(85893);P.Z=function(){var O,h,A=(0,le.a)(),d=A.system,me=(O=d.setting)===null||O===void 0?void 0:O.copyright,Y=[];if((h=d.setting)!==null&&h!==void 0&&h.recordNum){var k;Y.push({key:"recordNumber",title:(k=d.setting)===null||k===void 0?void 0:k.recordNum,href:"https://beian.miit.gov.cn/",blankTarget:!0})}return(0,Q.jsx)(pe.qc,{copyright:me||!1,links:Y})}},68759:function(N,P,e){"use strict";e.r(P),e.d(P,{default:function(){return lt}});var le=e(91220),pe=e(34792),Q=e(48086),O=e(11849),h=e(39428),A=e(3182),d=e(94657),me=e(17462),Y=e(76772),k=e(29791),Oe=e(89366),De=e(2603),ce=e(21307),i=e(67294),I=e(42285),ke=e(73727),Fe=e(27400),Ke=e(80582),wt=e(71194),He=e(50146),Ue=e(59879),Xe=e(43929),Ge=e(81354),F=e.n(Ge),ye=function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"XwKsGlMcdPMEhR1B",o=F().enc.Utf8.parse(s),n=F().enc.Utf8.parse(r),w=F().AES.encrypt(n,o,{mode:F().mode.ECB,padding:F().pad.Pkcs7});return w.toString()},xe=e(3980),Ve=e(9669),$e=e.n(Ve),Se=$e().create({timeout:4e4,headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json; charset=UTF-8"}});Se.interceptors.request.use(function(l){return l},function(l){Promise.reject(l)}),Se.interceptors.response.use(function(l){var r=l.data;return r});var Qe=function(r){return xe.hi.post("/captcha/get",r)};function Ye(l){return de.apply(this,arguments)}function de(){return de=(0,A.Z)((0,h.Z)().mark(function l(r){return(0,h.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",xe.hi.post("/captcha/check",r));case 1:case"end":return o.stop()}},l)})),de.apply(this,arguments)}var Je=e(79743),qe=e.n(Je),t=e(85893),K={mode:"fixed",vSpace:5,imgSize:{width:"310px",height:"200px"},barSize:{width:"310px",height:"40px"},setSize:{imgHeight:"200px",imgWidth:"310px",barHeight:"40px",barWidth:"310px"},blockSize:{width:"40px",height:"40px"}},_e=function(r){var s=K.vSpace,o=K.blockSize,n=K.setSize,w=K.imgSize,x=K.barSize,b=r.isShow,U=r.captchaType,J=U===void 0?"blockPuzzle":U,q=r.transitionLeft,X=q===void 0?"":q,g=r.transitionWidth,D=g===void 0?"":g,fe=r.verifyCaptcha,_=(0,i.useState)(""),ee=(0,d.Z)(_,2),G=ee[0],te=ee[1],ae=(0,i.useState)(""),re=(0,d.Z)(ae,2),se=re[0],B=re[1],p=(0,i.useState)("#1890ff"),m=(0,d.Z)(p,2),f=m[0],S=m[1],y=(0,i.useState)(!1),E=(0,d.Z)(y,2),R=E[0],j=E[1],ne=(0,i.useState)(!1),ve=(0,d.Z)(ne,2),u=ve[0],ge=ve[1],vt=(0,i.useState)(""),je=(0,d.Z)(vt,2),Le=je[0],V=je[1],gt=(0,i.useState)("\u5411\u53F3\u6ED1\u52A8\u5B8C\u6210\u9A8C\u8BC1"),Ce=(0,d.Z)(gt,2),ht=Ce[0],Ze=Ce[1],$=(0,i.useRef)(!1),we=(0,i.useRef)(0),T=(0,i.useRef)(0),pt=(0,i.useState)(0),Be=(0,d.Z)(pt,2),mt=Be[0],Ie=Be[1],yt=(0,i.useState)(0),Me=(0,d.Z)(yt,2),xt=Me[0],be=Me[1],he=(0,i.useRef)(0),Ee=(0,i.useRef)(0),Ne=(0,i.useRef)(""),Ae=(0,i.useRef)("");(0,i.useEffect)(function(){return St(),Re(),jt(),Lt},[]);var St=function(){for(var a=[],c="0123456789abcdef",C=0;C<36;C++)a[C]=c.substring(Math.floor(Math.random()*16),1);a[14]="4",a[19]=c.substring(Number(a[19])&3|8,1),a[8]=a[13]=a[18]=a[23]="-";var v="slider-".concat(a.join(""));localStorage.getItem("slider")||localStorage.setItem("slider",v)},jt=function(){window.addEventListener("touchmove",ie),window.addEventListener("mousemove",ie),window.addEventListener("touchend",oe),window.addEventListener("mouseup",oe)},Lt=function(){window.removeEventListener("touchmove",ie),window.removeEventListener("mousemove",ie),window.removeEventListener("touchend",oe),window.removeEventListener("mouseup",oe)},Re=function(){Qe({ts:Date.now(),captchaType:J,clientUid:localStorage.getItem("slider")}).then(function(a){if(a.success){var c=a.data||{},C=c.repCode,v=c.repData,z=c.repMsg,W=z===void 0?"":z;C==="0000"&&(Ne.current=v.token,Ae.current=v.secretKey,te(v.originalImageBase64),B(v.jigsawImageBase64)),C=="6201"&&(te(""),B(""),ge(!1),V(W),setTimeout(function(){V("")},1e3))}})},Te=function(a){a=a||window.event;var c=a.touches?a.touches[0].pageX:a.clientX;we.current=Math.floor(c-he.current),R==!1&&(Ze(""),$.current=!0,S("#1890ff"),a.stopPropagation())},ie=function(a){if(a=a||window.event,$.current&&R==!1){var c=a.touches?a.touches[0].pageX:a.clientX,C=he.current,v=c-C,z=parseInt(o.width),W=parseInt("".concat(z/2)),ue=Ee.current-W-2;v>=ue&&(v=ue),v<=24&&(v=W),T.current=v-we.current,Ie(T.current),be(T.current)}},ze=function(){Re(),T.current=0,Ie(T.current),be(T.current),Ze("\u5411\u53F3\u6ED1\u52A8\u5B8C\u6210\u9A8C\u8BC1"),S("#1890ff"),j(!1),$.current=!1},oe=function(){if($.current&&R==!1){var a=Ne.current,c=Ae.current,C=parseInt("".concat(T.current))*310/parseInt(n.imgWidth),v=JSON.stringify({x:C,y:5});Ye({captchaType:J,ts:Date.now(),token:a,pointJson:c?ye(v,c):v}).then(function(z){if(z.success){var W=z.data||{},ue=W.repCode,Zt=W.repMsg;if(ue==="0000"){j(!0),ge(!0),V("\u9A8C\u8BC1\u6210\u529F");var Pe="".concat(a,"---").concat(v);We(c?ye(Pe,c):Pe)}else j(!0),ge(!1),S("#d9534f"),V(Zt||"\u9A8C\u8BC1\u5931\u8D25");setTimeout(function(){ze(),V("")},1e3)}}),$.current=!1}},Ct=function L(a){var c=a&&a.getBoundingClientRect().left,C=a&&a.offsetWidth;he.current=c,Ee.current=C,c===0&&setTimeout(function(){L(a)},20)},We=function(a){fe(!1,a)};return(0,t.jsx)(He.Z,{title:"\u8BF7\u5B8C\u6210\u5B89\u5168\u9A8C\u8BC1",visible:b,footer:!1,destroyOnClose:!0,keyboard:!1,maskClosable:!1,width:parseInt(w.width)+48,onCancel:function(){return We()},bodyStyle:{padding:"12px 24px"},children:(0,t.jsx)("div",{className:"verifybox",children:(0,t.jsxs)("div",{style:{position:"relative"},className:"stop-user-select",children:[(0,t.jsx)("div",{className:"verify-img-out",style:{height:parseInt(n.imgHeight)+s},children:(0,t.jsxs)("div",{className:"verify-img-panel",style:{width:n.imgWidth,height:n.imgHeight},children:[(0,t.jsx)("div",{onClick:ze,style:{height:32,width:32,lineHeight:"32px",borderRadius:32,backgroundColor:"rgb(0, 0, 0, 0.2)",textAlign:"center",position:"absolute",top:4,right:4},children:(0,t.jsx)(Ue.Z,{style:{color:"#fff",fontSize:"16px",fontWeight:800}})}),(0,t.jsx)("img",{alt:"",src:G?"data:image/png;base64,".concat(G):qe(),style:{width:"100%",height:"100%",display:"block"}}),!!Le&&(0,t.jsx)("div",{className:"tips",children:(0,t.jsx)("span",{className:"verify-tips ".concat(u?"suc-bg":"err-bg"),children:Le})})]})}),(0,t.jsxs)("div",{className:"verify-bar-area",style:{width:n.imgWidth,height:x.height,lineHeight:x.height},ref:function(a){return Ct(a)},children:[(0,t.jsx)("span",{className:"verify-msg",children:ht}),(0,t.jsx)("div",{className:"verify-left-bar",style:{width:"".concat(mt,"px")||0,height:x.height,transition:D},children:(0,t.jsxs)("div",{onMouseDown:Te,onTouchStart:Te,className:"verify-move-block",style:{width:o.height,height:o.height,backgroundColor:f,left:"".concat(xt,"px"),transition:X},children:[(0,t.jsx)(Xe.Z,{style:{color:"#fff"}}),(0,t.jsx)("div",{className:"verify-sub-block",style:{width:"".concat(Math.floor(parseInt(n.imgWidth)*48/310),"px"),height:n.imgHeight,top:"-".concat(parseInt(n.imgHeight)+s,"px"),backgroundSize:"".concat(n.imgWidth," ").concat(n.imgHeight)},children:(0,t.jsx)("img",{alt:"",src:"data:image/png;base64,".concat(se),style:{width:"100%",height:"100%",display:"block"}})})]})})]})]})})})},et=_e,tt=e(5481),at=e.n(tt),rt=e(34687),Z=e.n(rt),st=e(98078),nt="MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCNcRNGaRRWgxIA0R9dGcbnaSddYWZTy1rHN0LGK1stMmKWN7Rp3D4LRXKdX7OCO3QYTPWNnxAu2L4Vz4NpytMdAHVI5Mq5ls2sJbFGDZ8SNyXiVAZ/dnZ2178CJE9ZgqgN2ZS/M7/LYDUT4SASh8T1jBCVmKYstkuk7pixqdKSFwIDAQAB",it=function(r,s){console.log(s);var o={log:!1},n=new st.Z(o);return n.setPublicKey(s||nt),n.encrypt(r)},Bt=function(r){var s=new JSEncrypt;return s.setPrivateKey(""),s.decrypt(r)},M=e(44335),ot=function(r){var s=r.content;return(0,t.jsx)(Y.Z,{style:{marginBottom:24},message:s,type:"error",showIcon:!0})},ut=function(r){var s,o=(0,i.useState)(!1),n=(0,d.Z)(o,2),w=n[0],x=n[1],b=(0,i.useState)(),U=(0,d.Z)(b,2),J=U[0],q=U[1],X=(0,Fe.a)(),g=X.system,D=(0,I.YB)(),fe=function(){var B=(0,A.Z)((0,h.Z)().mark(function p(){return(0,h.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:case"end":return f.stop()}},p)}));return function(){return B.apply(this,arguments)}}(),_=(0,i.useRef)();(0,i.useEffect)(function(){ft()},[]);var ee=(0,i.useState)(!1),G=(0,d.Z)(ee,2),te=G[0],ae=G[1],re=function(){var B=(0,A.Z)((0,h.Z)().mark(function p(m,f){var S,y,E;return(0,h.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(ae(m),S=_.current.getFieldsValue(),y=S.username,E=S.password,!(y&&E&&f)){j.next=5;break}return j.next=5,se({username:y,password:E,captchaVerification:f});case 5:x(!1);case 6:case"end":return j.stop()}},p)}));return function(m,f){return B.apply(this,arguments)}}(),se=function(){var B=(0,A.Z)((0,h.Z)().mark(function p(m){var f,S,y,E,R,j,ne;return(0,h.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,f=X.system.publicKey,u.next=4,X.login((0,O.Z)((0,O.Z)({},m),{},{password:it(m.password,f)}));case 4:if(S=u.sent,!S.success){u.next=19;break}if(y=D.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),Q.default.success(y),!r.onOk){u.next=11;break}return r.onOk(),u.abrupt("return");case 11:return u.next=13,fe();case 13:if(I.m8){u.next=15;break}return u.abrupt("return");case 15:return E=I.m8.location.query,R=E,j=R.redirect,I.m8.push(j||"/"),u.abrupt("return");case 19:q(S.message&&"error"),u.next=26;break;case 22:u.prev=22,u.t0=u.catch(0),ne=D.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),Q.default.error(ne);case 26:x(!1);case 27:case"end":return u.stop()}},p,null,[[0,22]])}));return function(m){return B.apply(this,arguments)}}();return(0,t.jsxs)("div",{className:Z().container,children:[(0,t.jsx)("div",{className:Z().lang,"data-lang":!0,children:I.pD&&(0,t.jsx)(I.pD,{})}),(0,t.jsxs)("div",{className:Z().content,children:[(0,t.jsxs)("div",{className:Z().top,children:[(0,t.jsxs)("div",{className:Z().header,children:[(0,t.jsx)("img",{alt:"logo",className:Z().logo,src:g.avatar?"/api/public/preview/".concat(g==null?void 0:g.avatar):at()}),(0,t.jsx)("span",{className:Z().title,children:g==null?void 0:g.name})]}),(0,t.jsx)("div",{className:Z().desc,children:g==null?void 0:g.description})]}),(0,t.jsx)("div",{className:Z().main,children:(0,t.jsxs)(ce.ZP,{formRef:_,initialValues:{autoLogin:!0},submitter:{searchConfig:{submitText:D.formatMessage({id:"pages.login.submit",defaultMessage:"\u767B\u5F55"})},render:function(p,m){return m.pop()},submitButtonProps:{loading:w,size:"large",style:{width:"100%"},htmlType:"submit"}},isKeyPressSubmit:!0,onFinish:function(){var B=(0,A.Z)((0,h.Z)().mark(function p(m){var f;return(0,h.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!w){y.next=2;break}return y.abrupt("return");case 2:(f=g.setting)!==null&&f!==void 0&&f.captchaEnabled?ae(!0):se(m),x(!0);case 4:case"end":return y.stop()}},p)}));return function(p){return B.apply(this,arguments)}}(),children:[J==="error"&&(0,t.jsx)(ot,{content:D.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF"})}),(0,t.jsx)(ce.V,{name:"username",fieldProps:{size:"large",prefix:(0,t.jsx)(Oe.Z,{className:Z().prefixIcon})},rules:[{required:!0,message:(0,t.jsx)(I._H,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,t.jsx)(ce.V.Password,{name:"password",fieldProps:{size:"large",prefix:(0,t.jsx)(De.Z,{className:Z().prefixIcon})},rules:[{required:!0,message:(0,t.jsx)(I._H,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]}),((s=g.registerInfo)===null||s===void 0?void 0:s.registerEnabled)&&(0,t.jsx)("div",{style:{marginBottom:24,display:"flex",justifyContent:"flex-end"},children:(0,t.jsx)(ke.rU,{to:"/user/register",children:(0,t.jsx)(I._H,{id:"pages.login.registerAccount",defaultMessage:"\u6CE8\u518C"})})})]})})]}),(0,t.jsx)(et,{isShow:te,verifyCaptcha:re}),(0,t.jsx)(k.Z,{})]})},lt=(0,Ke.Pi)(ut),H=(M.XZ===null||M.XZ===void 0?void 0:(0,M.XZ)())||[],ct=function(r){if(!(!r||!H.length)){var s=r.replace("_","-").toLowerCase(),o=H.map(function(b){return b.toLowerCase()}),n=o.findIndex(function(b){return b===s});if(n>=0)return H[n];var w=s.split("-")[0],x=o.findIndex(function(b){return b.split("-")[0]===w});if(x>=0)return H[x]}},dt=function(){if(typeof navigator!="undefined"){var r=Array.isArray(navigator.languages)&&navigator.languages.length?navigator.languages:[navigator.language],s=(0,le.Z)(r),o;try{for(s.s();!(o=s.n()).done;){var n=o.value,w=ct(n);if(w)return w}}catch(x){s.e(x)}finally{s.f()}return H[0]}},ft=function(){if(!(typeof window!="undefined"&&localStorage.getItem("umi_locale"))){var r=dt(),s=M.Kd===null||M.Kd===void 0?void 0:(0,M.Kd)();r&&r!==s&&(M.i_===null||M.i_===void 0||(0,M.i_)(r,!1))}}},5481:function(N,P,e){N.exports=e.p+"static/logo.efd90f0d.svg"},79743:function(N,P,e){N.exports=e.p+"static/default.aac93cd7.jpg"},42480:function(){}}]);
